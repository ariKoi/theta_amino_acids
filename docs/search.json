[
  {
    "objectID": "modeling_110624.html",
    "href": "modeling_110624.html",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "",
    "text": "Data source: Ref ranges - AAU file\nSee the file data_desc_040624 for the data processing steps that led to the above data and for a more detailed data description i.e. missing values per variable, typical values per variable etc.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---1st-pass",
    "href": "modeling_110624.html#model---1st-pass",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 1st Pass",
    "text": "Model - 1st Pass\nTo begin with, a test for non-linear relationships between each covariate and the amino acid concentration is executed below. This helps in deciding whether to model an association in a non-linear fashion i.e. with a polynomial term or a spline term or an interaction, or to just consider the covariates separately and without any special transformation.\n\n\n\n\n\n\n\n\nFigure 1: Spearman’s test for assessing non-linear relationships with the response. The further away from 0 the adjusted \\(\\rho^2\\) score is, the higher the degree of non-linearity for that covariate.\n\n\n\n\n\nNon-linearity is evident in covariates sex, aerobics_activity, age (smaller \\(\\rho^2\\)) and chronic_disease_v3 (smaller \\(\\rho^2\\) with opposite sign).\nFrom the data processing and description file implemented previously, aerobics_activity does not have many distinct values, has a low Info metric i.e. it does not meet criteria for a continuous variable. In addition due to the many zeroes it’s distribution is split in half (this hints to a subgroup analysis that will be executed later). As such using a polynomial term or a spline function in order to model its non-linear association with the amino acid concentration would not be appropriate. Age does not have continuity issues, however its adjusted \\(\\rho^2\\) value as seen in the above Spearman \\(\\rho^2\\) plots is not high enough to justify a spline approach. Hence to capture non-linearities only interactions amongst these 4 variables will be considered in the model. Specifically, the model formula will contain the following terms or associations:\nlog(Glycine) ~ sex + age + sex:age + bmi + chronic_disease_v3 + age:chronic_disease_v3 + supplements_flag + log(aerobics_activity+1) + log(resistance_activity+1) + age:log(aerobics_activity+1) + chronic_disease_v3:log(aerobics_activity+1)\nWhere the : symbol denotes the interaction between two variables. Once the model is built and the coefficients are estimated, the model formula can be seen below.\n\n\n[1] 7.202 - 1.074*(sex==Male) - 0.0157*age + 0.01201*bmi + 0.4433*(chronic_disease_v3==Thyroidism) - 0.242*(chronic_disease_v3==Other) - 1.235*(chronic_disease_v3==Blood) + 0.6188*(chronic_disease_v3==Heart) - 0.3686*(chronic_disease_v3==Stomach) - 0.6052*(chronic_disease_v3==Depression) - 7.866*(chronic_disease_v3==Pain) - 0.09208*(supplements_flag==Yes) - 0.003676*aerobics_activity + 0.0001581*resistance_activity + 0.01205*(sex==Male)*age + age*( - 0.00453*(chronic_disease_v3==Thyroidism) + 0.007319*(chronic_disease_v3==Other) + 0.02469*(chronic_disease_v3==Blood) - 0.009486*(chronic_disease_v3==Heart) + 0.01231*(chronic_disease_v3==Stomach) + 0.01946*(chronic_disease_v3==Depression) + 0.2042*(chronic_disease_v3==Pain)) - 0.0006687*age*aerobics_activity + aerobics_activity*( - 0.1042*(chronic_disease_v3==Thyroidism) + 0.04341*(chronic_disease_v3==Other) + 0.07868*(chronic_disease_v3==Blood) - 0.08097*(chronic_disease_v3==Heart) - 0.1181*(chronic_disease_v3==Stomach) - 0.08079*(chronic_disease_v3==Depression) - 0.5355*(chronic_disease_v3==Pain))\n\n\nThe model’s reference values can be seen below in the row named Adjust to.\n\n\n                   sex age  bmi chronic_disease_flag chronic_disease_v3 meds_flag supplements_flag aerobics_activity resistance_activity     Glycine\nLow:effect        &lt;NA&gt;  34 22.8                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                 0                   0   438.89752\nAdjust to       Female  43 25.3                   No               None        No               No                 0                   0   700.60805\nHigh:effect       &lt;NA&gt;  53 29.2                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                60                 540  1109.71268\nLow:prediction  Female  11 16.6                   No               None        No               No                 0                   0    84.40105\nHigh:prediction   Male  80 46.2                  Yes               Pain       Yes              Yes               720                 540 12859.68792\nLow             Female  11 16.6                   No               None        No               No                 0                   0    84.40105\nHigh              Male  80 46.2                  Yes               Pain       Yes              Yes               720                 540 12859.68792\n\nValues:\n\nsex : Female Male \nchronic_disease_flag : No Yes \nchronic_disease_v3 : None Thyroidism Other Blood Heart Stomach Depression Pain \nmeds_flag : No Yes \nsupplements_flag : No Yes \n\n\nSince this is a 1st pass for the model, with a view to detect outliers, more details and characteristics of the model are shown below when the 2nd pass is undertaken.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#outlier-analysis-based-on-model-residuals",
    "href": "modeling_110624.html#outlier-analysis-based-on-model-residuals",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Outlier analysis based on model residuals",
    "text": "Outlier analysis based on model residuals\nWhen assessing the residuals from the model fit using a normal probability plot, we see the presence of large residuals i.e. difference of the observed and predicted values. These residuals correspond to model predictions that produced larger errors than the bulk of the data. They are indicative of cases that can’t be explained well by the model (i.e. missing covariate information, prediction extrapolation from unseen by the model covariate values etc), and as such can be cast as outliers. This is also appropriate in terms of developing a model that will be used for reference interval construction i.e. cases foreign to the model should fall outside the reference interval and flagged both as inconclusive and for further inspection.\n\n\n------------------------------------------------------------------------------------------------------------------------------------------------------------------ \nResidual Distribution - Glycine Model\n\n  length      n       NAs  unique    0s  mean  meanCI'\n     308    217        91     = n     0  0.00   -0.09\n          70.5%     29.5%          0.0%          0.09\n                                                     \n     .05    .10       .25  median   .75   .90     .95\n   -1.10  -0.85     -0.44    0.00  0.34  0.84    1.20\n                                                     \n   range     sd     vcoef     mad   IQR  skew    kurt\n    4.12   0.70  8.53e+15    0.56  0.77  0.51    1.23\n                                                     \nlowest : -1.77, -1.66, -1.50, -1.48, -1.44\nhighest: 1.77, 1.99, 2.24, 2.34, 2.35\n\n' 95%-CI (classic)\n\n\n\n\n\n\n\n\nFigure 2: Figure combining a histogram with a density plot, a boxplot and the plot of the empirical distribution function (ECDF). The scale for the x-axis is synchronized over all plots. The median can be found on the boxplot as also in the ecdf-plot. The maximum and the minimum value are tagged with a tiny vertical dash upon the ecdf-line. The mean is shown in the boxplot as grey cross, the grey bar is its confidence interval.\n\n\n\n\n\nIn comparison to the previous outlier analysis as seen here, the difference now is that the analysis is conducted on the model residuals, hence on values that are conditional on meta data (predictor variables) whereas previously the analysis was marginally or unconditionally executed with the only assumption being that of the amino acid concentration following a log-normal distribution.\nFigure 3 shows a quantile-quantile plot where the quantiles of the model’s residual values are matched to the ones predicted from a normal distribution. The diagonal line indicates perfect fit. Data points marked in red denote outliers (also indicated in the table below each plot with their corresponding subject IDs).\nFor the rest of the figures below (i.e. for other amino acids), the same outlier detection procedure is applied but with a different parameterization which controls the outlier detection thresholds (i.e. horizontal lines in plot).\n\n\n\n\n\n\n\n\nFigure 3: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutliers\n\n\nSubject id1\nGlycine2\n\n\n\n\n39769\n1.71\n\n\n39834\n1.99\n\n\nKOYTSOY\n1.56\n\n\n39921\n2.34\n\n\n39689\n1.77\n\n\n39454\n1.66\n\n\n39432\n2.24\n\n\n39452\n2.35\n\n\n\n1 Red coloured data points in above QQ plot\n\n\n2 μmol/g (model residual)",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---2nd-pass",
    "href": "modeling_110624.html#model---2nd-pass",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 2nd Pass",
    "text": "Model - 2nd Pass\nHere the model is refitted to the data excluding the outlier values detected in the previous step.\nModel formula:\n\n\n[1] 7.076 - 1.153*(sex==Male) - 0.01157*age + 0.002986*bmi + 0.1132*(chronic_disease_v3==Thyroidism) + 0.0435*(chronic_disease_v3==Other) - 0.4287*(chronic_disease_v3==Blood) + 0.6272*(chronic_disease_v3==Heart) + 0.09502*(chronic_disease_v3==Stomach) - 0.3794*(chronic_disease_v3==Depression) - 8.162*(chronic_disease_v3==Pain) - 0.0591*(supplements_flag==Yes) + 0.06704*aerobics_activity + 0.01453*resistance_activity + 0.01358*(sex==Male)*age + age*(0.003604*(chronic_disease_v3==Thyroidism) + 0.004287*(chronic_disease_v3==Other) + 0.01304*(chronic_disease_v3==Blood) - 0.007724*(chronic_disease_v3==Heart) + 0.005611*(chronic_disease_v3==Stomach) + 0.01955*(chronic_disease_v3==Depression) + 0.2159*(chronic_disease_v3==Pain)) - 0.001689*age*aerobics_activity + aerobics_activity*( - 0.1078*(chronic_disease_v3==Thyroidism) + 0.008825*(chronic_disease_v3==Other) + 0.01427*(chronic_disease_v3==Blood) - 0.09928*(chronic_disease_v3==Heart) - 0.154*(chronic_disease_v3==Stomach) - 0.1192*(chronic_disease_v3==Depression) - 0.6338*(chronic_disease_v3==Pain))\n\n\nThe model’s reference values can be seen below in the row named Adjust to:\n\n\n                   id    sex age   bmi chronic_disease_flag chronic_disease_v3 meds_flag supplements_flag aerobics_activity resistance_activity    Glycine\nLow:effect       &lt;NA&gt;   &lt;NA&gt;  34 22.75                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                 0                   0  432.94967\nAdjust to       24486 Female  43 25.30                   No               None        No               No                 0                   0  685.57339\nHigh:effect      &lt;NA&gt;   &lt;NA&gt;  53 29.00                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                60                 540 1068.24863\nLow:prediction   1018 Female  11 16.60                   No               None        No               No                 0                   0   84.40105\nHigh:prediction NAKOS   Male  80 46.20                  Yes               Pain       Yes              Yes               720                 540 6945.17194\nLow              1018 Female  11 16.60                   No               None        No               No                 0                   0   84.40105\nHigh            NAKOS   Male  80 46.20                  Yes               Pain       Yes              Yes               720                 540 6945.17194\n\nValues:\n\nid : 1018 10985 1210 1219 1326 1338 1378 162 1623 1960 2024_1 2024_10 2024_11 2024_12 2024_2 2024_3 2024_4 2024_5 2024_6 2024_7 + 288 others \nsex : Female Male \nchronic_disease_flag : No Yes \nchronic_disease_v3 : None Thyroidism Other Blood Heart Stomach Depression Pain \nmeds_flag : No Yes \nsupplements_flag : No Yes \n\n\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 4: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 5: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 6: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Glycine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nage\n\n\n34.00\n\n\n53\n\n\n19.00\n\n\n-0.21970\n\n\n0.15080\n\n\n-0.51730\n\n\n0.07784\n\n\n\n\nbmi\n\n\n22.75\n\n\n29\n\n\n6.25\n\n\n0.01866\n\n\n0.06005\n\n\n-0.09983\n\n\n0.13720\n\n\n\n\naerobics_activity\n\n\n0.00\n\n\n60\n\n\n60.00\n\n\n-0.02294\n\n\n0.11190\n\n\n-0.24370\n\n\n0.19790\n\n\n\n\nresistance_activity\n\n\n0.00\n\n\n540\n\n\n540.00\n\n\n0.09145\n\n\n0.14610\n\n\n-0.19690\n\n\n0.37980\n\n\n\n\nsex — Male:Female\n\n\n1.00\n\n\n2\n\n\n\n\n-0.56930\n\n\n0.09645\n\n\n-0.75960\n\n\n-0.37900\n\n\n\n\nchronic_disease_v3 — Thyroidism:None\n\n\n1.00\n\n\n2\n\n\n\n\n0.26820\n\n\n0.18750\n\n\n-0.10190\n\n\n0.63820\n\n\n\n\nchronic_disease_v3 — Other:None\n\n\n1.00\n\n\n3\n\n\n\n\n0.22780\n\n\n0.18690\n\n\n-0.14090\n\n\n0.59660\n\n\n\n\nchronic_disease_v3 — Blood:None\n\n\n1.00\n\n\n4\n\n\n\n\n0.13210\n\n\n0.37310\n\n\n-0.60420\n\n\n0.86830\n\n\n\n\nchronic_disease_v3 — Heart:None\n\n\n1.00\n\n\n5\n\n\n\n\n0.29510\n\n\n0.41640\n\n\n-0.52650\n\n\n1.11700\n\n\n\n\nchronic_disease_v3 — Stomach:None\n\n\n1.00\n\n\n6\n\n\n\n\n0.33630\n\n\n0.30880\n\n\n-0.27310\n\n\n0.94570\n\n\n\n\nchronic_disease_v3 — Depression:None\n\n\n1.00\n\n\n7\n\n\n\n\n0.46140\n\n\n0.37620\n\n\n-0.28100\n\n\n1.20400\n\n\n\n\nchronic_disease_v3 — Pain:None\n\n\n1.00\n\n\n8\n\n\n\n\n1.12100\n\n\n0.67810\n\n\n-0.21700\n\n\n2.45900\n\n\n\n\nsupplements_flag — Yes:No\n\n\n1.00\n\n\n2\n\n\n\n\n-0.05910\n\n\n0.10370\n\n\n-0.26380\n\n\n0.14560\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 7: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.\n\n\n\n\n\n\n\nPartial Dependence Plots\n\n\n\n\n\n\n\n\nFigure 8\n\n\n\n\n\n\n\n\n\n\n\nFigure 9\n\n\n\n\n\n\n\n\n\n\n\nFigure 10\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 11\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 12\n\n\n\n\n\n\n\n\n\n\n\nFigure 13\n\n\n\n\n\n\n\n\n\n\n\nFigure 14\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 15\n\n\n\n\n\n\n\n\n\n\n\nFigure 16\n\n\n\n\n\n\n\n\n\n\n\nFigure 17\n\n\n\n\n\n\n\n\n\n\n\nFigure 18",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#additional-data-collection-sample-size-suggestions",
    "href": "modeling_110624.html#additional-data-collection-sample-size-suggestions",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Additional Data Collection & Sample Size Suggestions",
    "text": "Additional Data Collection & Sample Size Suggestions\nThe data contains responses from 300 individuals, however the model uses 209 complete cases i.e. the rest contain missing values at various covariates and are thus excluded from modeling (at the moment no imputation technique is used as it is not thought that covariates can predict each other well). The 2nd pass model is built upon most of the covariates and data, and utilizes 29 degrees of freedom. As is mentioned below for the 3rd pass model development, these many degrees of freedom are too many for the current sample size, and as a result the 2nd pass model overfits the data. In order to use and obtain a trustworthy result for the 2nd pass model, the sample size should be about 435 individuals. Given that new data will also contain responses with missing values, the suggestion would be to collect in total about 550 responses or an additional 250 responses.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---3rd-pass",
    "href": "modeling_110624.html#model---3rd-pass",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 3rd Pass",
    "text": "Model - 3rd Pass\nThe 2nd pass model uses too many degrees of freedom in relation to the size of the data. This can be seen by conducting a validation and calibration analysis. Below are results from the validation analysis using bootstrapping as the resampling technique. The algorithm can be described as follows source:\n\nEstimate model performance in the original sample of size n\nDraw a bootstrap sample of the same size n and fit the model to the bootstrap sample\nApply the model obtained in the bootstrap sample to the original sample\nSubtract the accuracy measure found in the bootstrap sample from the accuracy measure in the original sample - this is the estimate of optimism (i.e. overfitting)\nRepeat the process many times (e.g. 300) and average over the repeats to obtain a final estimate of optimism for each measure\nSubtract that value from the observed/apparent accuracy measure to get the optimism corrected estimate\n\n\n\n\n\n2nd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.27\n\n\n0.36\n\n\n0.13\n\n\n0.22\n\n\n0.05\n\n\n78\n\n\n\n\nMSE\n\n\n0.33\n\n\n0.3\n\n\n0.4\n\n\n-0.1\n\n\n0.44\n\n\n78\n\n\n\n\n\\(g\\)\n\n\n0.41\n\n\n0.46\n\n\n0.33\n\n\n0.13\n\n\n0.28\n\n\n78\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n1.99\n\n\n-1.99\n\n\n1.99\n\n\n78\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.69\n\n\n0.31\n\n\n0.69\n\n\n78\n\n\n\n\n\nFrom this table it can be seen that the optimism statistic which indicates the extent of model overfitting, for a variety of performance metrics has values that are large. Thus overfitting is present in the model.\nBy calibrating the predicted values from the model to the observed ones, we also notice a good amount of deviation from the diagonal line after correcting for this overfitting or bias.\n\n\n\nn=209   Mean absolute error=0.054   Mean squared error=0.00438\n0.9 Quantile of absolute error=0.109\n\n\n\n\n\n\n\n\nFigure 19: Calibration plot for 2nd pass model. Deviation from the diagonal line after correcting for overfitting or bias.\n\n\n\n\n\nThe 2nd pass model also includes the chronic_disease_v3 variable which contains categories with low frequencies in the data. As a result the effect size estimate is accompanied by a very large confidence interval. This renders the estimate as non-trustworthy.\nFrom these results and also the variable importance plot seen previously as well as the analysis of variance results, it looks like the variables, sex, age and aerobics_activity can be kept in a new model with less degree of freedom spending i.e. less overfitting the data.\nHence the model is refitted to the data with these three covariates and interactions between sex & age and between age & aerobics_activity.\nThe model formula is:\n\n\n[1] 7.03 - 1.112*(sex==Male) - 0.005608*age + 0.094*aerobics_activity + 0.01383*(sex==Male)*age - 0.002978*age*aerobics_activity\n\n\nThe model’s reference values can be seen below in the row named Adjust to:\n\n\n                   id    sex age   bmi chronic_disease_flag chronic_disease_v3 meds_flag supplements_flag aerobics_activity resistance_activity    Glycine\nLow:effect       &lt;NA&gt;   &lt;NA&gt;  34 22.75                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                 0                   0  432.94967\nAdjust to       24486 Female  43 25.30                   No               None        No               No                 0                   0  685.57339\nHigh:effect      &lt;NA&gt;   &lt;NA&gt;  53 29.00                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                60                 540 1068.24863\nLow:prediction   1018 Female  11 16.60                   No               None        No               No                 0                   0   84.40105\nHigh:prediction NAKOS   Male  80 46.20                  Yes               Pain       Yes              Yes               720                 540 6945.17194\nLow              1018 Female  11 16.60                   No               None        No               No                 0                   0   84.40105\nHigh            NAKOS   Male  80 46.20                  Yes               Pain       Yes              Yes               720                 540 6945.17194\n\nValues:\n\nid : 1018 10985 1210 1219 1326 1338 1378 162 1623 1960 2024_1 2024_10 2024_11 2024_12 2024_2 2024_3 2024_4 2024_5 2024_6 2024_7 + 288 others \nsex : Female Male \nchronic_disease_flag : No Yes \nchronic_disease_v3 : None Thyroidism Other Blood Heart Stomach Depression Pain \nmeds_flag : No Yes \nsupplements_flag : No Yes \n\n\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 20: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers. Here the algorithm reports outliers due to its parameterization, however these are weak outliers since their deviation from the straight line is not large.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 21: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 22: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Glycine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nage\n\n\n34\n\n\n53\n\n\n19\n\n\n-0.1065\n\n\n0.08776\n\n\n-0.2794\n\n\n0.066340\n\n\n\n\naerobics_activity\n\n\n0\n\n\n60\n\n\n60\n\n\n-0.1400\n\n\n0.07170\n\n\n-0.2812\n\n\n0.001298\n\n\n\n\nsex — Male:Female\n\n\n1\n\n\n2\n\n\n\n\n-0.5174\n\n\n0.08392\n\n\n-0.6827\n\n\n-0.352000\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 23: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.\n\n\n\n\n\n\n\nPartial Dependence Plots\n\n\n\n\n\n\n\n\nFigure 24: Effect of sex. Female subjects seem to have higher levels of Glycine concentration.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 25: Effect of age. Older subjects seem to have lower levels of Glycine concentration.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 26: Effect of aerobics_activity. Aerobics seem to reduce the concentration of Glycine but at a relatively slow pace as the exercise duration increases.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 27: Interaction between sex and age. As age increases the concentration of Glycine between males and females seems to converge to the same value.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 28: Interaction between sex and aerobics_activity. Parallel lines denote no interaction.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 29: Simultaneous effects of age and aerobics_activity. Younger/Older subjects with larger aerobic exercise durations seem to have higher/lower concentrations of Glycine. Older subjects who exercise less seem to have higher concentrations of Glycine when compared to older subjects who exercise more.\n\n\n\n\n\n\n\nValidation & Calibration\n\n\n\n\n3rd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.18\n\n\n0.19\n\n\n0.16\n\n\n0.03\n\n\n0.15\n\n\n300\n\n\n\n\nMSE\n\n\n0.38\n\n\n0.37\n\n\n0.39\n\n\n-0.02\n\n\n0.4\n\n\n300\n\n\n\n\n\\(g\\)\n\n\n0.33\n\n\n0.33\n\n\n0.31\n\n\n0.02\n\n\n0.31\n\n\n300\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n0.32\n\n\n-0.32\n\n\n0.32\n\n\n300\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.95\n\n\n0.05\n\n\n0.95\n\n\n300\n\n\n\n\n\nWe note also that the successful number of resamples is 300 (i.e. the number of bootstrap samples that we have chosen to perform the validation). In contrast, the 2nd pass model did not use all of the 300 resamples due to divergence or singularity issues which occurred in 222 samples, and thus left only 78 resamples to use for the validation. These divergence issues were due to reasons such as missing values, categories of the chronic_disease_v3 variable with a low frequency and the complexity of the model.\nIn addition this 3rd pass model has used 243 individuals instead of 209 that were used by the 2nd pass model i.e. the smaller number of covariates used in the 3rd pass model have fewer missing values.\n\n\n\nn=243   Mean absolute error=0.02   Mean squared error=0.00064\n0.9 Quantile of absolute error=0.037\n\n\n\n\n\n\n\n\nFigure 30: Calibration plot for 3rd pass model. Deviation from the diagonal line after correcting for overfitting or bias. It can be seen that deviations have been reduced compared to the 2nd pass model.\n\n\n\n\n\n\n\nDynamic Reference Intervals\nThe following table shows an example of the construction of a 95% reference interval (RI) for each of four subjects with specific covariate values. For the 3rd pass model only sex, age and aerobics_activity make a difference since the rest of the covariates are not used.\n\n\n\n  \n\n\n\nThe RI for Glycine from Mayo Clinic Laboratories for ages above 18 years is 229 to 2989 μmol/g of creatinine.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---1st-pass-1",
    "href": "modeling_110624.html#model---1st-pass-1",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 1st Pass",
    "text": "Model - 1st Pass\nTest for non-linear relationships between each covariate and the amino acid concentration is executed below. This helps in deciding whether to model an association in a non-linear fashion i.e. with a polynomial term or a spline term or an interaction, or to just consider the covariates separately and without any special transformation.\n\n\n\n\n\n\n\n\nFigure 31: Spearman’s test for assessing non-linear relationships with the response. The further away from 0 the adjusted \\(\\rho^2\\) score is, the higher the degree of non-linearity for that covariate.\n\n\n\n\n\nNon-linearity is evident in covariates sex, aerobics_activity, age (smaller \\(\\rho^2\\) with opposite sign), bmi (smaller \\(\\rho^2\\) with opposite sign) and chronic_disease_v3 (\\(\\rho^2\\) with opposite sign).\nTo capture non-linearities, only interactions amongst these 4 variables will be considered in the model. Specifically, the model formula will contain the following terms or associations:\nlog(Alanine) ~ sex + age + sex:age + bmi + chronic_disease_v3 + age:chronic_disease_v3 + supplements_flag + log(aerobics_activity+1) + log(resistance_activity+1) + age:log(aerobics_activity+1) + chronic_disease_v3:log(aerobics_activity+1) + sex:bmi + bmi:log(aerobics_activity+1) + age:bmi + bmi:chronic_disease_v3 + bmi:supplements_flag + age:supplements_flag + sex:supplements_flag + sex:log(aerobics_activity+1)\nWhere the : symbol denotes the interaction between two variables.\nSince this is a 1st pass for the model, with a view to detect outliers, more details and characteristics of the model are shown below when the 2nd pass is undertaken.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#outlier-analysis-based-on-model-residuals-1",
    "href": "modeling_110624.html#outlier-analysis-based-on-model-residuals-1",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Outlier analysis based on model residuals",
    "text": "Outlier analysis based on model residuals\nWhen assessing the residuals from the model fit using a normal probability plot, we see the presence of large residuals i.e. difference of the observed and predicted values. These residuals correspond to model predictions that produced larger errors than the bulk of the data. They are indicative of cases that can’t be explained well by the model (i.e. missing covariate information, prediction extrapolation from unseen by the model covariate values etc), and as such can be cast as outliers. This is also appropriate in terms of developing a model that will be used for reference interval construction i.e. cases foreign to the model should fall outside the reference interval and flagged both as inconclusive and for further inspection.\n\n\n------------------------------------------------------------------------------------------------------------------------------------------------------------------ \nResidual Distribution - Alanine Model\n\n  length      n       NAs  unique    0s  mean  meanCI'\n     308    217        91     = n     0  0.00   -0.10\n          70.5%     29.5%          0.0%          0.10\n                                                     \n     .05    .10       .25  median   .75   .90     .95\n   -1.17  -0.94     -0.48   -0.02  0.40  0.95    1.47\n                                                     \n   range     sd     vcoef     mad   IQR  skew    kurt\n    4.12   0.75  7.62e+15    0.68  0.89  0.48    0.30\n                                                     \nlowest : -1.58, -1.54, -1.45, -1.36, -1.35\nhighest: 1.73, 1.77, 1.99, 2.07, 2.53\n\n' 95%-CI (classic)\n\n\n\n\n\n\n\n\nFigure 32: Figure combining a histogram with a density plot, a boxplot and the plot of the empirical distribution function (ECDF). The scale for the x-axis is synchronized over all plots. The median can be found on the boxplot as also in the ecdf-plot. The maximum and the minimum value are tagged with a tiny vertical dash upon the ecdf-line. The mean is shown in the boxplot as grey cross, the grey bar is its confidence interval.\n\n\n\n\n\nIn comparison to the previous outlier analysis as seen here, the difference now is that the analysis is conducted on the model residuals, hence on values that are conditional on meta data (predictor variables) whereas previously the analysis was marginally or unconditionally executed with the only assumption being that of the amino acid concentration following a log-normal distribution.\nFigure 33 shows a quantile-quantile plot where the quantiles of the model’s residual values are matched to the ones predicted from a normal distribution. The diagonal line indicates the ideal fit. Data points marked in red denote outliers (also indicated in the table below each plot with their corresponding subject IDs).\nFor the rest of the figures below (i.e. for other amino acids), the same outlier detection procedure is applied but with a different parameterization which controls the outlier detection thresholds (i.e. horizontal lines in plot).\n\n\n\n\n\n\n\n\nFigure 33: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutliers\n\n\nSubject id1\nAlanine2\n\n\n\n\n571\n−1.58\n\n\n41823\n2.07\n\n\n39799\n2.53\n\n\n42879\n1.99\n\n\n\n1 Red coloured data points in above QQ plot\n\n\n2 μmol/g (model residual)",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---2nd-pass-1",
    "href": "modeling_110624.html#model---2nd-pass-1",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 2nd Pass",
    "text": "Model - 2nd Pass\nHere the model is refitted to the data excluding the outlier values detected in the previous step.\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 34: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed weak outliers (the strong ones detected by the 1st pass model have been removed).\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 35: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 36: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Alanine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nage\n\n\n34.25\n\n\n53.00\n\n\n18.75\n\n\n0.002985\n\n\n0.1982\n\n\n-0.38840\n\n\n0.3943\n\n\n\n\nbmi\n\n\n22.90\n\n\n29.35\n\n\n6.45\n\n\n-0.034680\n\n\n0.1273\n\n\n-0.28610\n\n\n0.2167\n\n\n\n\naerobics_activity\n\n\n0.00\n\n\n60.00\n\n\n60.00\n\n\n-0.162800\n\n\n0.1685\n\n\n-0.49540\n\n\n0.1699\n\n\n\n\nresistance_activity\n\n\n0.00\n\n\n540.00\n\n\n540.00\n\n\n0.023450\n\n\n0.1954\n\n\n-0.36220\n\n\n0.4092\n\n\n\n\nsex — Male:Female\n\n\n1.00\n\n\n2.00\n\n\n\n\n-0.653700\n\n\n0.1922\n\n\n-1.03300\n\n\n-0.2743\n\n\n\n\nchronic_disease_v3 — Thyroidism:None\n\n\n1.00\n\n\n2.00\n\n\n\n\n-0.097710\n\n\n0.2452\n\n\n-0.58180\n\n\n0.3863\n\n\n\n\nchronic_disease_v3 — Other:None\n\n\n1.00\n\n\n3.00\n\n\n\n\n0.250300\n\n\n0.2391\n\n\n-0.22160\n\n\n0.7223\n\n\n\n\nchronic_disease_v3 — Blood:None\n\n\n1.00\n\n\n4.00\n\n\n\n\n-0.320000\n\n\n0.4643\n\n\n-1.23700\n\n\n0.5966\n\n\n\n\nchronic_disease_v3 — Heart:None\n\n\n1.00\n\n\n5.00\n\n\n\n\n0.539600\n\n\n0.5862\n\n\n-0.61760\n\n\n1.6970\n\n\n\n\nchronic_disease_v3 — Stomach:None\n\n\n1.00\n\n\n6.00\n\n\n\n\n-0.149300\n\n\n0.4837\n\n\n-1.10400\n\n\n0.8057\n\n\n\n\nchronic_disease_v3 — Depression:None\n\n\n1.00\n\n\n7.00\n\n\n\n\n0.023430\n\n\n0.6691\n\n\n-1.29800\n\n\n1.3440\n\n\n\n\nchronic_disease_v3 — Pain:None\n\n\n1.00\n\n\n8.00\n\n\n\n\n2.103000\n\n\n1.0820\n\n\n-0.03355\n\n\n4.2400\n\n\n\n\nsupplements_flag — Yes:No\n\n\n1.00\n\n\n2.00\n\n\n\n\n0.367900\n\n\n0.1704\n\n\n0.03139\n\n\n0.7044\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 37: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---3rd-pass-1",
    "href": "modeling_110624.html#model---3rd-pass-1",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 3rd Pass",
    "text": "Model - 3rd Pass\nThe 2nd pass model uses too many degrees of freedom in relation to the size of the data. This can be seen by conducting a validation and calibration analysis. Below are results from the validation analysis using bootstrapping as the resampling technique. The algorithm can be described as follows source:\n\nEstimate model performance in the original sample of size n\nDraw a bootstrap sample of the same size n and fit the model to the bootstrap sample\nApply the model obtained in the bootstrap sample to the original sample\nSubtract the accuracy measure found in the bootstrap sample from the accuracy measure in the original sample - this is the estimate of optimism (i.e. overfitting)\nRepeat the process many times (e.g. 300) and average over the repeats to obtain a final estimate of optimism for each measure\nSubtract that value from the observed/apparent accuracy measure to get the optimism corrected estimate\n\n\n\n\n\n2nd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.32\n\n\n0.46\n\n\n-0.33\n\n\n0.79\n\n\n-0.47\n\n\n14\n\n\n\n\nMSE\n\n\n0.48\n\n\n0.38\n\n\n0.94\n\n\n-0.56\n\n\n1.03\n\n\n14\n\n\n\n\n\\(g\\)\n\n\n0.53\n\n\n0.64\n\n\n0.35\n\n\n0.29\n\n\n0.24\n\n\n14\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n3.02\n\n\n-3.02\n\n\n3.02\n\n\n14\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.5\n\n\n0.5\n\n\n0.5\n\n\n14\n\n\n\n\n\nFrom this table it can be seen that the optimism statistic which indicates the extent of model overfitting, for a variety of performance metrics has values that are large. Thus overfitting is present in the model.\nBy calibrating the predicted values from the model to the observed ones, we also notice a good amount of deviation from the diagonal line (ideal model performance) after correcting for this overfitting or bias.\n\n\n\nn=213   Mean absolute error=0.092   Mean squared error=0.0128\n0.9 Quantile of absolute error=0.156\n\n\n\n\n\n\n\n\nFigure 38: Calibration plot for 2nd pass model. Deviation from the diagonal line after correcting for overfitting or bias.\n\n\n\n\n\nThe 2nd pass model also includes the chronic_disease_v3 variable which contains categories with low frequencies in the data. As a result the effect size estimate is accompanied by a very large confidence interval. This renders the estimate as non-trustworthy.\nFrom these results and also the variable importance plot seen previously as well as the analysis of variance results, it looks like the variables, sex and supplements_flag can be kept in a new model with less degree of freedom spending i.e. less overfitting the data.\nHence the model is refitted to the data with these just 2 covariates (Note: Situation might change when more data are collected and the model is refit).\nThe model formula is:\n\n\n[1] 6.127 - 0.5242*(sex==Male) + 0.1736*(supplements_flag==Yes)\n\n\nThe model’s reference values can be seen below in the row named Adjust to:\n\n\n                   id    sex   age   bmi chronic_disease_flag chronic_disease_v3 meds_flag supplements_flag aerobics_activity resistance_activity    Alanine\nLow:effect       &lt;NA&gt;   &lt;NA&gt; 34.25 22.90                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                 0                   0  214.88371\nAdjust to       24486 Female 43.00 25.40                   No               None        No               No                 0                   0  369.56649\nHigh:effect      &lt;NA&gt;   &lt;NA&gt; 53.00 29.35                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                60                 540  664.93536\nLow:prediction   1018 Female 11.00 16.80                   No               None        No               No                 0                   0   29.49669\nHigh:prediction NAKOS   Male 80.00 46.20                  Yes               Pain       Yes              Yes               720                 540 4643.48731\nLow              1018 Female 11.00 16.80                   No               None        No               No                 0                   0   29.49669\nHigh            NAKOS   Male 80.00 46.20                  Yes               Pain       Yes              Yes               720                 540 4643.48731\n\nValues:\n\nid : 1018 10985 1210 1219 1326 1338 1378 162 1623 1960 2024_1 2024_10 2024_11 2024_12 2024_2 2024_3 2024_4 2024_5 2024_6 2024_7 + 292 others \nsex : Female Male \nchronic_disease_flag : No Yes \nchronic_disease_v3 : None Thyroidism Other Blood Heart Stomach Depression Pain \nmeds_flag : No Yes \nsupplements_flag : No Yes \n\n\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 39: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers. Here the algorithm reports outliers due to its parameterization, however these are weak outliers since their deviation from the straight line is not large.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 40: Plot of predictions vs model residuals. No obvious patterns can be seen. Since the model covariates are binary, there are four unique predictions, one for each combination of sex and supplements_flag category.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 41: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Alanine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nsex — Male:Female\n\n\n1\n\n\n2\n\n\n\n\n-0.5242\n\n\n0.1029\n\n\n-0.72690\n\n\n-0.3214\n\n\n\n\nsupplements_flag — Yes:No\n\n\n1\n\n\n2\n\n\n\n\n0.1736\n\n\n0.1061\n\n\n-0.03533\n\n\n0.3825\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 42: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.\n\n\n\n\n\n\n\nPartial Dependence Plots\n\n\n\n\n\n\n\n\nFigure 43: Effect of sex. Female subjects seem to have higher levels of Alanine concentration.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 44: Effect of supplement intake. Taking supplements seems to increase levels of Alanine concentration, but without strong evidence.\n\n\n\n\n\n\n\nValidation & Calibration\n\n\n\n\n3rd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.11\n\n\n0.11\n\n\n0.1\n\n\n0.02\n\n\n0.09\n\n\n300\n\n\n\n\nMSE\n\n\n0.62\n\n\n0.61\n\n\n0.62\n\n\n-0.01\n\n\n0.63\n\n\n300\n\n\n\n\n\\(g\\)\n\n\n0.29\n\n\n0.29\n\n\n0.28\n\n\n0.01\n\n\n0.28\n\n\n300\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n0.1\n\n\n-0.1\n\n\n0.1\n\n\n300\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.98\n\n\n0.02\n\n\n0.98\n\n\n300\n\n\n\n\n\nWe note also that the successful number of resamples is 300 (i.e. the number of bootstrap samples that we have chosen to perform the validation). In contrast, the 2nd pass model did not use all of the 300 resamples due to divergence or singularity issues which occurred in 286 samples, and thus left only 14 resamples to use for the validation. These divergence issues were due to reasons such as missing values, categories of the chronic_disease_v3 variable with a low frequency and the complexity of the model.\nIn addition this 3rd pass model has used 254 individuals instead of 213 that were used by the 2nd pass model i.e. the smaller number of covariates used in the 3rd pass model have fewer missing values.\n\n\n\nn=254   Mean absolute error=0.033   Mean squared error=0.0012\n0.9 Quantile of absolute error=0.048\n\n\n\n\n\n\n\n\nFigure 45: Calibration plot for 3rd pass model. Deviation from the diagonal line after correcting for overfitting or bias. It can be seen that deviations have been reduced compared to the 2nd pass model.\n\n\n\n\n\n\n\nDynamic Reference Intervals\nThe following table shows an example of the construction of a 95% reference interval (RI) for each of four subjects with specific covariate values. For the 3rd pass model only sex and supplements_flag make a difference since the rest of the covariates are not used.\n\n\n\n  \n\n\n\nThe RI for Alanine from Mayo Clinic Laboratories for ages above 18 years is 56 to 560 μmol/g of creatinine.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---1st-pass-2",
    "href": "modeling_110624.html#model---1st-pass-2",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 1st Pass",
    "text": "Model - 1st Pass\nTest for non-linear relationships between each covariate and the amino acid concentration is executed below. This helps in deciding whether to model an association in a non-linear fashion i.e. with a polynomial term or a spline term or an interaction, or to just consider the covariates separately and without any special transformation.\n\n\n\n\n\n\n\n\nFigure 46: Spearman’s test for assessing non-linear relationships with the response. The further away from 0 the adjusted \\(\\rho^2\\) score is, the higher the degree of non-linearity for that covariate.\n\n\n\n\n\nNon-linearity is evident in covariates sex, resistance_activity, bmi and chronic_disease_v3. However their \\(\\rho^2\\) values are very small, hence non-linearity strength is very low.\nTo capture non-linearities, only interactions amongst these 4 variables are considered in the model. Specifically, the model formula contains the following terms or associations:\nlog(Valine) ~ sex + age + bmi + chronic_disease_v3 + supplements_flag + log(aerobics_activity+1) + log(resistance_activity+1) + sex:bmi + sex:log(resistance_activity+1) + log(resistance_activity+1):chronic_disease_v3 + log(resistance_activity+1):bmi\nWhere the : symbol denotes the interaction between two variables.\nEven though this model uses information from all meta data covariates, and is in addition quite complex due to the modeled interactions, the global significance of the model is very small i.e. global p-value based on the Likelihood Ratio Test is 0.62, well above the 0.05 typical threshold. As a result, and after different combinations of the covariates were tested in the model, the best model was the one including only bmi and resistance_activity as covariates. This model had a global regression p-value of 0.0542 (marginally significant). To note, this statistic is further improved with the 2nd pass model below i.e. p-value of 0.0175\nThus the 1st pass model formula is:\nlog(Valine) ~ bmi + log(resistance_activity+1)\nSince this is a 1st pass for the model, with a view to detect outliers, more details and characteristics of the model are shown below when the 2nd pass is undertaken.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#outlier-analysis-based-on-model-residuals-2",
    "href": "modeling_110624.html#outlier-analysis-based-on-model-residuals-2",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Outlier analysis based on model residuals",
    "text": "Outlier analysis based on model residuals\nWhen assessing the residuals from the model fit using a normal probability plot, we see the presence of large residuals i.e. difference of the observed and predicted values. These residuals correspond to model predictions that produced larger errors than the bulk of the data. They are indicative of cases that can’t be explained well by the model (i.e. missing covariate information, prediction extrapolation from unseen by the model covariate values etc), and as such can be cast as outliers. This is also appropriate in terms of developing a model that will be used for reference interval construction i.e. cases foreign to the model should fall outside the reference interval and flagged both as inconclusive and for further inspection.\n\n\n------------------------------------------------------------------------------------------------------------------------------------------------------------------ \nResidual Distribution - Valine Model\n\n  length      n       NAs  unique    0s   mean  meanCI'\n     308    235        73     = n     0   0.00   -0.07\n          76.3%     23.7%          0.0%           0.07\n                                                      \n     .05    .10       .25  median   .75    .90     .95\n   -0.92  -0.59     -0.20    0.06  0.31   0.56    0.63\n                                                      \n   range     sd     vcoef     mad   IQR   skew    kurt\n    4.67   0.53  6.97e+15    0.39  0.52  -1.78    7.10\n                                                      \nlowest : -3.25, -2.22, -1.78, -1.57, -1.39\nhighest: 0.78, 0.81, 0.87, 0.91, 1.42\n\n' 95%-CI (classic)\n\n\n\n\n\n\n\n\nFigure 47: Figure combining a histogram with a density plot, a boxplot and the plot of the empirical distribution function (ECDF). The scale for the x-axis is synchronized over all plots. The median can be found on the boxplot as also in the ecdf-plot. The maximum and the minimum value are tagged with a tiny vertical dash upon the ecdf-line. The mean is shown in the boxplot as grey cross, the grey bar is its confidence interval.\n\n\n\n\n\nIn comparison to the previous outlier analysis as seen here, the difference now is that the analysis is conducted on the model residuals, hence on values that are conditional on meta data (predictor variables) whereas previously the analysis was marginally or unconditionally executed with the only assumption being that of the amino acid concentration following a log-normal distribution.\nFigure 48 shows a quantile-quantile plot where the quantiles of the model’s residual values are matched to the ones predicted from a normal distribution. The diagonal line indicates the ideal fit. Data points marked in red denote outliers (also indicated in the table below each plot with their corresponding subject IDs).\nFor the rest of the figures below (i.e. for other amino acids), the same outlier detection procedure is applied but with a different parameterization which controls the outlier detection thresholds (i.e. horizontal lines in plot).\n\n\n\n\n\n\n\n\nFigure 48: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutliers\n\n\nSubject id1\nValine2\n\n\n\n\n42534\n−1.78\n\n\n41757\n−1.14\n\n\n41731\n−1.57\n\n\n41602\n−1.26\n\n\n40691\n−2.22\n\n\n39756\n−3.25\n\n\n40030\n−1.39\n\n\n39948\n−1.10\n\n\n42021\n−1.36\n\n\nKOYTSOY\n1.42\n\n\n\n1 Red coloured data points in above QQ plot\n\n\n2 μmol/g (model residual)",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---2nd-pass-2",
    "href": "modeling_110624.html#model---2nd-pass-2",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 2nd Pass",
    "text": "Model - 2nd Pass\nHere the model is refitted to the data excluding the outlier values detected in the previous step.\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 49: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed weak outliers (the strong ones detected by the 1st pass model have been removed).\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 50: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 51: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Valine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nbmi\n\n\n22.8\n\n\n29.1\n\n\n6.3\n\n\n0.05646\n\n\n0.03123\n\n\n-0.005082\n\n\n0.118000\n\n\n\n\nresistance_activity\n\n\n0.0\n\n\n450.0\n\n\n450.0\n\n\n-0.14610\n\n\n0.07464\n\n\n-0.293200\n\n\n0.001033\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 52: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.\n\n\n\n\n\nFor Valine, there’s no 3rd pass model since the 2nd pass is built on just 2 covariates and does not overfit.\nThe model formula is:\n\n\n[1] 3.026 + 0.008961*bmi - 0.0239*resistance_activity\n\n\nThe model’s reference values can be seen below in the row named Adjust to:\n\n\n                   id    sex age  bmi chronic_disease_flag chronic_disease_v3 meds_flag supplements_flag aerobics_activity resistance_activity     Valine\nLow:effect       &lt;NA&gt;   &lt;NA&gt;  34 22.8                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                 0                   0  19.898679\nAdjust to       24486 Female  43 25.3                   No               None        No               No                 0                   0  25.720098\nHigh:effect      &lt;NA&gt;   &lt;NA&gt;  53 29.1                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                60                 450  33.542445\nLow:prediction   1018 Female  11 16.6                   No               None        No               No                 0                   0   2.780384\nHigh:prediction NAKOS   Male  80 46.2                  Yes               Pain       Yes              Yes               720                 450 111.080120\nLow              1018 Female  11 16.6                   No               None        No               No                 0                   0   2.780384\nHigh            NAKOS   Male  80 46.2                  Yes               Pain       Yes              Yes               720                 450 111.080120\n\nValues:\n\nid : 1018 10985 1210 1219 1326 1338 1378 162 1623 1960 2024_1 2024_10 2024_11 2024_12 2024_2 2024_3 2024_4 2024_5 2024_6 2024_7 + 286 others \nsex : Female Male \nchronic_disease_flag : No Yes \nchronic_disease_v3 : None Thyroidism Other Blood Heart Stomach Depression Pain \nmeds_flag : No Yes \nsupplements_flag : No Yes \n\n\n\n\nPartial Dependence Plots\n\n\n\n\n\n\n\n\nFigure 53: Effect of bmi. Valine concentration increasing with bmi on average.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 54: Effect of resistance training. Spending more time on resistance training seems to decrease levels of Valine concentration, but at a relatively slow pace. The effect is more prominent from no resistance training to about 4 hours per week i.e. 250/60\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 55: Simultaneous effects of bmi and resistance_activity. Individuals who do not include resistance training in their fitness program have higher levels of Valine concentration, and those levels increase with the bmi.\n\n\n\n\n\n\n\nValidation & Calibration\nTo assess model performance, a validation and calibration analysis is conducted below as with other amino acids. Below are results from the validation analysis using bootstrapping as the resampling technique. The algorithm can be described as follows source:\n\nEstimate model performance in the original sample of size n\nDraw a bootstrap sample of the same size n and fit the model to the bootstrap sample\nApply the model obtained in the bootstrap sample to the original sample\nSubtract the accuracy measure found in the bootstrap sample from the accuracy measure in the original sample - this is the estimate of optimism (i.e. overfitting)\nRepeat the process many times (e.g. 300) and average over the repeats to obtain a final estimate of optimism for each measure\nSubtract that value from the observed/apparent accuracy measure to get the optimism corrected estimate\n\n\n\n\n\n2nd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.04\n\n\n0.04\n\n\n0.02\n\n\n0.02\n\n\n0.01\n\n\n300\n\n\n\n\nMSE\n\n\n0.15\n\n\n0.14\n\n\n0.15\n\n\n0\n\n\n0.15\n\n\n300\n\n\n\n\n\\(g\\)\n\n\n0.08\n\n\n0.09\n\n\n0.08\n\n\n0.01\n\n\n0.07\n\n\n300\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n0.17\n\n\n-0.17\n\n\n0.17\n\n\n300\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.95\n\n\n0.05\n\n\n0.95\n\n\n300\n\n\n\n\n\n\n\n\nn=225   Mean absolute error=0.015   Mean squared error=3e-04\n0.9 Quantile of absolute error=0.025\n\n\n\n\n\n\n\n\nFigure 56: Calibration plot for 2nd pass model. Deviation from the diagonal line after correcting for overfitting or bias. The larger deviations occur to the left of the plot which means that the model has some tendency to underestimate the true Valine concentration value i.e. if the model predicts 23.33 μmol/g, then actual is 23.33*exp(mae=0.015) = 23.68 μmol/g\n\n\n\n\n\n\n\nDynamic Reference Intervals\nThe following table shows an example of the construction of a 95% reference interval (RI) for each of four subjects with specific covariate values. For the 2nd pass model only bmi and resistance_activity make a difference since the rest of the covariates are not used.\n\n\n\n  \n\n\n\nThe RI for Valine from Mayo Clinic Laboratories for ages above 18 years is 11 to 88 μmol/g of creatinine.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---1st-pass-3",
    "href": "modeling_110624.html#model---1st-pass-3",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 1st Pass",
    "text": "Model - 1st Pass\nTest for non-linear relationships between each covariate and the amino acid concentration is executed below. This helps in deciding whether to model an association in a non-linear fashion i.e. with a polynomial term or a spline term or an interaction, or to just consider the covariates separately and without any special transformation.\n\n\n\n\n\n\n\n\nFigure 57: Spearman’s test for assessing non-linear relationships with the response. The further away from 0 the adjusted \\(\\rho^2\\) score is, the higher the degree of non-linearity for that covariate.\n\n\n\n\n\nNon-linearity evident in bmi, resistance_activity (smaller \\(\\rho^2\\) with opposite sign), chronic_disease_v3 (smaller \\(\\rho^2\\) with opposite sign). Most rho values are relatively small though with bmi being the exception\nTo capture non linearities, interactions amongst these 3 variables will be considered, as well as splines for bmi. Also age will be included as it has some linearity association:\nlog(Cysteine) ~ rcs(bmi, 4) + age + chronic_disease_v3 + log(resistance_activity+1) + log(resistance_activity+1):rcs(bmi, 4)\nWhere the : symbol denotes the interaction between two variables and rcs denotes a restricted cubic spline transformation with 4 knots.\nSince this is a 1st pass for the model, with a view to detect outliers, more details and characteristics of the model are shown below when the 2nd pass is undertaken.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#outlier-analysis-based-on-model-residuals-3",
    "href": "modeling_110624.html#outlier-analysis-based-on-model-residuals-3",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Outlier analysis based on model residuals",
    "text": "Outlier analysis based on model residuals\nWhen assessing the residuals from the model fit using a normal probability plot, we see the presence of large residuals i.e. difference of the observed and predicted values. These residuals correspond to model predictions that produced larger errors than the bulk of the data. They are indicative of cases that can’t be explained well by the model (i.e. missing covariate information, prediction extrapolation from unseen by the model covariate values etc), and as such can be cast as outliers. This is also appropriate in terms of developing a model that will be used for reference interval construction i.e. cases foreign to the model should fall outside the reference interval and flagged both as inconclusive and for further inspection.\n\n\n------------------------------------------------------------------------------------------------------------------------------------------------------------------ \nResidual Distribution - Cysteine Model\n\n  length      n       NAs  unique    0s   mean  meanCI'\n     192    155        37     = n     0   0.00   -0.11\n          80.7%     19.3%          0.0%           0.11\n                                                      \n     .05    .10       .25  median   .75    .90     .95\n   -1.36  -0.85     -0.42    0.03  0.40   0.88    1.14\n                                                      \n   range     sd     vcoef     mad   IQR   skew    kurt\n    4.50   0.72  8.21e+15    0.63  0.82  -0.39    0.69\n                                                      \nlowest : -2.70, -1.65, -1.58, -1.56, -1.53\nhighest: 1.32, 1.35, 1.39, 1.41, 1.80\n\n' 95%-CI (classic)\n\n\n\n\n\n\n\n\nFigure 58: Figure combining a histogram with a density plot, a boxplot and the plot of the empirical distribution function (ECDF). The scale for the x-axis is synchronized over all plots. The median can be found on the boxplot as also in the ecdf-plot. The maximum and the minimum value are tagged with a tiny vertical dash upon the ecdf-line. The mean is shown in the boxplot as grey cross, the grey bar is its confidence interval.\n\n\n\n\n\nIn comparison to the previous outlier analysis as seen here, the difference now is that the analysis is conducted on the model residuals, hence on values that are conditional on meta data (predictor variables) whereas previously the analysis was marginally or unconditionally executed with the only assumption being that of the amino acid concentration following a log-normal distribution.\nFigure 59 shows a quantile-quantile plot where the quantiles of the model’s residual values are matched to the ones predicted from a normal distribution. The diagonal line indicates the ideal fit. Data points marked in red denote outliers (also indicated in the table below each plot with their corresponding subject IDs).\nFor the rest of the figures below (i.e. for other amino acids), the same outlier detection procedure is applied but with a different parameterization which controls the outlier detection thresholds (i.e. horizontal lines in plot).\n\n\n\n\n\n\n\n\nFigure 59: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutliers\n\n\nSubject id1\nCysteine2\n\n\n\n\n2024_7\n−2.70\n\n\n\n1 Red coloured data points in above QQ plot\n\n\n2 μmol/g (model residual)",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---2nd-pass-3",
    "href": "modeling_110624.html#model---2nd-pass-3",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 2nd Pass",
    "text": "Model - 2nd Pass\nHere the model is refitted to the data excluding the outlier values detected in the previous step.\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 60: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed weak outliers (the strong ones detected by the 1st pass model have been removed).\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 61: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 62: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Cysteine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nbmi\n\n\n23.25\n\n\n30.3\n\n\n7.05\n\n\n0.32730\n\n\n0.19520\n\n\n-0.058600\n\n\n0.71330\n\n\n\n\nage\n\n\n35.00\n\n\n52.0\n\n\n17.00\n\n\n0.11730\n\n\n0.08842\n\n\n-0.057530\n\n\n0.29220\n\n\n\n\nresistance_activity\n\n\n0.00\n\n\n42.5\n\n\n42.50\n\n\n0.29170\n\n\n0.14650\n\n\n0.002049\n\n\n0.58130\n\n\n\n\nchronic_disease_v3 — Thyroidism:None\n\n\n1.00\n\n\n2.0\n\n\n\n\n-0.07755\n\n\n0.19310\n\n\n-0.459400\n\n\n0.30430\n\n\n\n\nchronic_disease_v3 — Other:None\n\n\n1.00\n\n\n3.0\n\n\n\n\n0.15410\n\n\n0.21360\n\n\n-0.268300\n\n\n0.57640\n\n\n\n\nchronic_disease_v3 — Blood:None\n\n\n1.00\n\n\n4.0\n\n\n\n\n0.05171\n\n\n0.24080\n\n\n-0.424500\n\n\n0.52790\n\n\n\n\nchronic_disease_v3 — Heart:None\n\n\n1.00\n\n\n5.0\n\n\n\n\n-0.16380\n\n\n0.30430\n\n\n-0.765500\n\n\n0.43800\n\n\n\n\nchronic_disease_v3 — Stomach:None\n\n\n1.00\n\n\n6.0\n\n\n\n\n-0.12680\n\n\n0.28320\n\n\n-0.686700\n\n\n0.43310\n\n\n\n\nchronic_disease_v3 — Depression:None\n\n\n1.00\n\n\n7.0\n\n\n\n\n-0.71560\n\n\n0.37190\n\n\n-1.451000\n\n\n0.01981\n\n\n\n\nchronic_disease_v3 — Pain:None\n\n\n1.00\n\n\n8.0\n\n\n\n\n0.22440\n\n\n0.43780\n\n\n-0.641200\n\n\n1.09000\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 63: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---3rd-pass-2",
    "href": "modeling_110624.html#model---3rd-pass-2",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 3rd Pass",
    "text": "Model - 3rd Pass\nThe 2nd pass model uses too many degrees of freedom (df) in relation to the size of the data i.e. 10 df should be spent instead of the 16 from the model. This can be seen by conducting a validation and calibration analysis. Below are results from the validation analysis using bootstrapping as the resampling technique. The algorithm can be described as follows source:\n\nEstimate model performance in the original sample of size n\nDraw a bootstrap sample of the same size n and fit the model to the bootstrap sample\nApply the model obtained in the bootstrap sample to the original sample\nSubtract the accuracy measure found in the bootstrap sample from the accuracy measure in the original sample - this is the estimate of optimism (i.e. overfitting)\nRepeat the process many times (e.g. 300) and average over the repeats to obtain a final estimate of optimism for each measure\nSubtract that value from the observed/apparent accuracy measure to get the optimism corrected estimate\n\n\n\n\n\n2nd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.15\n\n\n0.21\n\n\n0.04\n\n\n0.18\n\n\n-0.03\n\n\n278\n\n\n\n\nMSE\n\n\n0.47\n\n\n0.43\n\n\n0.52\n\n\n-0.1\n\n\n0.56\n\n\n278\n\n\n\n\n\\(g\\)\n\n\n0.31\n\n\n0.37\n\n\n0.24\n\n\n0.13\n\n\n0.18\n\n\n278\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n0.96\n\n\n-0.96\n\n\n0.96\n\n\n278\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.63\n\n\n0.37\n\n\n0.63\n\n\n278\n\n\n\n\n\nFrom this table it can be seen that the optimism statistic which indicates the extent of model overfitting, for a variety of performance metrics has values that are large. Thus overfitting is present in the model.\nBy calibrating the predicted values from the model to the observed ones, we also notice a good amount of deviation from the diagonal line (ideal model performance) after correcting for this overfitting or bias.\n\n\n\nn=154   Mean absolute error=0.066   Mean squared error=0.00811\n0.9 Quantile of absolute error=0.174\n\n\n\n\n\n\n\n\nFigure 64: Calibration plot for 2nd pass model. Deviation from the diagonal line after correcting for overfitting or bias.\n\n\n\n\n\nThe 2nd pass model also includes the chronic_disease_v3 variable which contains categories with low frequencies in the data. As a result the effect size estimate is accompanied by a very large confidence interval. This renders the estimate as non-trustworthy.\nFrom these results and also the variable importance plot seen previously as well as the analysis of variance results, it looks like the variables, bmi, age and resistance_activity can be kept in a new model with less degree of freedom spending i.e. less overfitting the data.\nHence the model is refitted to the data with these just 3 covariates (Note: Situation might change when more data are collected and the model is refit).\nThe model formula is:\n\n\n[1] 5.207 - 0.1402*bmi + 0.002925*pmax(bmi - 20.34,0)^3 - 0.006532*pmax(bmi - 24.1,0)^3 + 0.00387*pmax(bmi - 27.82,0)^3 - 0.0002636*pmax(bmi - 36.99,0)^3 + 0.007099*age - 1.257*resistance_activity + resistance_activity*(0.05867*bmi - 0.001282*pmax(bmi - 20.34,0)^3 + 0.003158*pmax(bmi - 24.1,0)^3 - 0.002112*pmax(bmi - 27.82,0)^3 + 0.0002357*pmax(bmi - 36.99,0)^3)\n\n\nThe model’s reference values can be seen below in the row named Adjust to:\n\n\n                   id    sex age   bmi chronic_disease_flag chronic_disease_v3 meds_flag supplements_flag aerobics_activity resistance_activity  Cysteine\nLow:effect       &lt;NA&gt;   &lt;NA&gt;  35 23.25                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                 0                 0.0  8.819153\nAdjust to       39953 Female  43 25.60                   No               None        No               No                 0                 0.0 14.050352\nHigh:effect      &lt;NA&gt;   &lt;NA&gt;  52 30.30                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                75                42.5 21.604960\nLow:prediction   1018 Female  11 16.60                   No               None        No               No                 0                 0.0  1.494633\nHigh:prediction NAKOS   Male  78 46.20                  Yes               Pain       Yes              Yes               720               540.0 82.317026\nLow              1018 Female  11 16.60                   No               None        No               No                 0                 0.0  1.494633\nHigh            NAKOS   Male  78 46.20                  Yes               Pain       Yes              Yes               720               540.0 82.317026\n\nValues:\n\nid : 1018 10985 1210 1338 162 1960 2024_1 2024_10 2024_12 2024_2 2024_3 2024_5 2046 2299 25821 25983 26849 34006 34734 35010 + 189 others \nsex : Female Male \nchronic_disease_flag : No Yes \nchronic_disease_v3 : None Thyroidism Other Blood Heart Stomach Depression Pain \nmeds_flag : No Yes \nsupplements_flag : No Yes \n\n\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 65: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers. Here the algorithm reports outliers due to its parameterization, however these are weak outliers since their deviation from the straight line is not large.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 66: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 67: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Cysteine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nbmi\n\n\n23.25\n\n\n30.3\n\n\n7.05\n\n\n0.3326\n\n\n0.19120\n\n\n-0.04525\n\n\n0.7104\n\n\n\n\nage\n\n\n35.00\n\n\n52.0\n\n\n17.00\n\n\n0.1207\n\n\n0.07642\n\n\n-0.03035\n\n\n0.2717\n\n\n\n\nresistance_activity\n\n\n0.00\n\n\n42.5\n\n\n42.50\n\n\n0.2620\n\n\n0.14040\n\n\n-0.01559\n\n\n0.5395\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 68: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.\n\n\n\n\n\n\n\nPartial Dependence Plots\n\n\n\n\n\n\n\n\nFigure 69: Nonlinear effect of bmi. Cysteine concentration levels can be seen to decrease until the age of 24 and thereafter steadily but slowly increase with increasing bmi.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 70: Effect of age. Age is seen to increase the levels of Cysteine concentration.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 71: Effect of resistance_activity. Resistance training is seen to increase the levels of Cysteine concentration, especially when moving from no training at all to increasing training durations per week. The pace of increase is slow.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 72: Simultaneous effects of bmi and resistance_activity. Cysteine concentration levels are seen to increase with the increase of bmi and the duration of resistance training, particularly beyond the bmi threshold of 35 \\(kg/m^2\\)\n\n\n\n\n\n\n\nValidation & Calibration\n\n\n\n\n3rd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.11\n\n\n0.15\n\n\n0.05\n\n\n0.1\n\n\n0.01\n\n\n300\n\n\n\n\nMSE\n\n\n0.48\n\n\n0.46\n\n\n0.52\n\n\n-0.06\n\n\n0.55\n\n\n300\n\n\n\n\n\\(g\\)\n\n\n0.28\n\n\n0.31\n\n\n0.23\n\n\n0.08\n\n\n0.2\n\n\n300\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n0.64\n\n\n-0.64\n\n\n0.64\n\n\n300\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.75\n\n\n0.25\n\n\n0.75\n\n\n300\n\n\n\n\n\nWe note also that the successful number of resamples is 300 (i.e. the number of bootstrap samples that we have chosen to perform the validation). In contrast, the 2nd pass model did not use all of the 300 resamples due to divergence or singularity issues which occurred in 22 samples, and thus left only 278 resamples to use for the validation. These divergence issues were due to reasons such as missing values, categories of the chronic_disease_v3 variable with a low frequency and the complexity of the model.\nIn addition this 3rd pass model has used only 154 individuals from the current pool of 308 due the many zero or non-detection cases in the data.\n\n\n\nn=154   Mean absolute error=0.07   Mean squared error=0.00704\n0.9 Quantile of absolute error=0.127\n\n\n\n\n\n\n\n\nFigure 73: Calibration plot for 3rd pass model. Deviation from the diagonal line after correcting for overfitting or bias. It can be seen that deviations have been reduced compared to the 2nd pass model, especially on the right side, but not on the middle and left parts of the comparison. On the middle part there is some overestimation while on the left there is underestimation of the true values. This is perhaps due to the currently small sample size of 154 individuals upon which the models have been built.\n\n\n\n\n\n\n\nDynamic Reference Intervals\nThe following table shows an example of the construction of a 95% reference interval (RI) for each of four subjects with specific covariate values. For the 3rd pass model only bmi, age and resistance_activity make a difference since the rest of the covariates are not used.\n\n\n\n  \n\n\n\nThe RI for Cysteine from Mayo Clinic Laboratories for ages above 18 years is 12 to 98 μmol/g of creatinine.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---1st-pass-4",
    "href": "modeling_110624.html#model---1st-pass-4",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 1st Pass",
    "text": "Model - 1st Pass\nTest for non-linear relationships between each covariate and the amino acid concentration is executed below. This helps in deciding whether to model an association in a non-linear fashion i.e. with a polynomial term or a spline term or an interaction, or to just consider the covariates separately and without any special transformation.\n\n\n\n\n\n\n\n\nFigure 74: Spearman’s test for assessing non-linear relationships with the response. The further away from 0 the adjusted \\(\\rho^2\\) score is, the higher the degree of non-linearity for that covariate.\n\n\n\n\n\nLinearity is evident in aerobics_activity (relevant plot not shown). Non-linearity is evident in covariates age, resistance_activity, bmi and chronic_disease_v3. However their \\(\\rho^2\\) values are very small, hence non-linearity strength is very low.\nTo capture non-linearities, only interactions amongst these 5 variables are considered in the model.\nAfter different combinations of the covariates were tested in the model, the best model was the one including only aerobics_activity as the single covariate. This model had a global regression p-value of 0.078 (marginally significant).\nThus the 1st pass model formula is:\nlog(Taurine) ~ log(aerobics_activity+1)\nSince this is a 1st pass for the model, with a view to detect outliers, more details and characteristics of the model are shown below when the 2nd pass is undertaken.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#outlier-analysis-based-on-model-residuals-4",
    "href": "modeling_110624.html#outlier-analysis-based-on-model-residuals-4",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Outlier analysis based on model residuals",
    "text": "Outlier analysis based on model residuals\nWhen assessing the residuals from the model fit using a normal probability plot, we see the presence of large residuals i.e. difference of the observed and predicted values. These residuals correspond to model predictions that produced larger errors than the bulk of the data. They are indicative of cases that can’t be explained well by the model (i.e. missing covariate information, prediction extrapolation from unseen by the model covariate values etc), and as such can be cast as outliers. This is also appropriate in terms of developing a model that will be used for reference interval construction i.e. cases foreign to the model should fall outside the reference interval and flagged both as inconclusive and for further inspection.\n\n\n------------------------------------------------------------------------------------------------------------------------------------------------------------------ \nResidual Distribution - Taurine Model :\n  Concentration per Creatinine gramm\n\n\n  length       n       NAs  unique    0s   mean  meanCI'\n     299     299         0     = n     0   0.00   -0.12\n          100.0%      0.0%          0.0%           0.12\n                                                       \n     .05     .10       .25  median   .75    .90     .95\n   -1.82   -1.28     -0.56    0.03  0.61   1.36    1.85\n                                                       \n   range      sd     vcoef     mad   IQR   skew    kurt\n    7.07    1.07  5.01e+15    0.87  1.17  -0.15    0.87\n                                                       \nlowest : -4.05, -3.17, -3.04, -2.58, -2.51\nhighest: 2.37, 2.58, 2.60, 2.76, 3.02\n\n' 95%-CI (classic)\n\n\n\n\n\n\n\n\nFigure 75: Figure combining a histogram with a density plot, a boxplot and the plot of the empirical distribution function (ECDF). The scale for the x-axis is synchronized over all plots. The median can be found on the boxplot as also in the ecdf-plot. The maximum and the minimum value are tagged with a tiny vertical dash upon the ecdf-line. The mean is shown in the boxplot as grey cross, the grey bar is its confidence interval.\n\n\n\n\n\nIn comparison to the previous outlier analysis as seen here, the difference now is that the analysis is conducted on the model residuals, hence on values that are conditional on meta data (predictor variables) whereas previously the analysis was marginally or unconditionally executed with the only assumption being that of the amino acid concentration following a log-normal distribution.\nFigure 76 shows a quantile-quantile plot where the quantiles of the model’s residual values are matched to the ones predicted from a normal distribution. The diagonal line indicates the ideal fit. Data points marked in red denote outliers (also indicated in the table below each plot with their corresponding subject IDs).\nFor the rest of the figures below (i.e. for other amino acids), the same outlier detection procedure is applied but with a different parameterization which controls the outlier detection thresholds (i.e. horizontal lines in plot).\n\n\n\n\n\n\n\n\nFigure 76: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutliers\n\n\nSubject id1\nTaurine2\n\n\n\n\n40691\n−3.17\n\n\n40782\n−4.05\n\n\n680\n−3.04\n\n\n\n1 Red coloured data points in above QQ plot\n\n\n2 μmol/g (model residual)",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---2nd-pass-4",
    "href": "modeling_110624.html#model---2nd-pass-4",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 2nd Pass",
    "text": "Model - 2nd Pass\nHere the model is refitted to the data excluding the outlier values detected in the previous step.\nUtilizing the same model formula as in the 1st pass model i.e. a model with only aerobics_activity as a covariate did not result into global regression significance. As a result a new model formula was searched with the following being the best found:\nlog(Taurine) ~ rcs(age,3) + supplements_flag + rcs(age,3):supplements_flag + log(aerobics_activity+1) + supplements_flag:log(aerobics_activity+1) + sex + sex:supplements_flag\nWhere : denotes an interaction term and rcs a restricted cubic spline to capture non-linear association. However this model, even after an extensive search using a variety of covariate combinations, still does not have global regression significance with a p-value close to 0.14. Since this is currently the only option, this model is kept as the 2nd pass model (it is hoped that with more data global regression significance can be achieved).\n\nResiduals & Model Refit\n\n\n\n\n\n\n\n\nFigure 77: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are typically deemed weak outliers (the strong ones detected by the 1st pass model have been removed). An exception for the Taurine case is that there’s still is a strong outlier present, which can be seen on the right side of the plot. This data point is further removed from the data and the 2nd pass model is refit again.\n\n\n\n\n\nAs an exception to previously analysed amino acids, here there was an additional strong outlier that was removed from the data. This corresponds to the subject id 34734 as shown in the table below.\n\n\n\n\n\n\n\n\n\nOutliers\n\n\nSubject id1\nTaurine2\n\n\n\n\n571\n−2.61\n\n\n34734\n3.39\n\n\n\n1 Red coloured data points in above QQ plot\n\n\n2 μmol/g (model residual)\n\n\n\n\n\n\n\n\n\nThe 2nd pass model was then refit one more time (without id 34734) using the same last model formula:\nlog(Taurine) ~ rcs(age,3) + supplements_flag + rcs(age,3):supplements_flag + log(aerobics_activity+1) + supplements_flag:log(aerobics_activity+1) + sex + sex:supplements_flag\nThis version of the model resulted in marginal globla regression significance with a p-value of 0.06 and the updated residual qq plot below.\n\n\n\n\n\n\n\n\nFigure 78: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are typically deemed weak outliers (the strong ones detected by the 1st and 2nd pass models have been removed).\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 79: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 80: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Taurine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nage\n\n\n34\n\n\n53\n\n\n19\n\n\n0.08265\n\n\n0.1115\n\n\n-0.13700\n\n\n0.30230\n\n\n\n\naerobics_activity\n\n\n0\n\n\n60\n\n\n60\n\n\n0.09023\n\n\n0.1387\n\n\n-0.18300\n\n\n0.36350\n\n\n\n\nsupplements_flag — Yes:No\n\n\n1\n\n\n2\n\n\n\n\n0.39710\n\n\n0.2221\n\n\n-0.04059\n\n\n0.83470\n\n\n\n\nsex — Male:Female\n\n\n1\n\n\n2\n\n\n\n\n-0.22530\n\n\n0.1606\n\n\n-0.54160\n\n\n0.09108\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 81: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.\n\n\n\n\n\nFor Taurine, there’s no 3rd pass model due to the difficulties in establishing a significant model and the fact that 10 degrees of freedom are spent by the model from an empirical max of 16.\nThe model formula is:\n\n\n[1] 7.205 - 0.02189* age + 2.927e - 05*pmax(age - 26.1,0)^3 - 5.676e - 05*pmax(age - 43,0)^3 + 2.749e - 05*pmax(age - 61,0)^3 + 0.387*(supplements_flag==Yes) + 0.02195*aerobics_activity - 0.2253*(sex==Male) + (supplements_flag==Yes)*(0.003115* age - 2.567e - 05*pmax(age - 26.1,0)^3 + 4.977e - 05*pmax(age - 43,0)^3 - 2.41e - 05*pmax(age - 61,0)^3) - 0.1019*(supplements_flag==Yes)*aerobics_activity + 0.5623*(supplements_flag==Yes)*(sex==Male)\n\n\nThe model’s reference values can be seen below in the row named Adjust to:\n\n\n                   id    sex age  bmi chronic_disease_flag chronic_disease_v3 meds_flag supplements_flag aerobics_activity resistance_activity     Taurine\nLow:effect       &lt;NA&gt;   &lt;NA&gt;  34 22.8                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                 0                   0   437.45744\nAdjust to       24486 Female  43 25.3                   No               None        No               No                 0                   0   773.26965\nHigh:effect      &lt;NA&gt;   &lt;NA&gt;  53 29.1                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                60                 540  1386.79205\nLow:prediction   1018 Female  11 16.6                   No               None        No               No                 0                   0    58.61601\nHigh:prediction NAKOS   Male  80 46.2                  Yes               Pain       Yes              Yes               720                 540 13049.87097\nLow              1018 Female  11 16.6                   No               None        No               No                 0                   0    58.61601\nHigh            NAKOS   Male  80 46.2                  Yes               Pain       Yes              Yes               720                 540 13049.87097\n\nValues:\n\nid : 1018 10985 1210 1219 1326 1338 1378 162 1623 1960 2024_1 2024_11 2024_12 2024_2 2024_3 2024_4 2024_5 2024_6 2024_7 2024_8 + 284 others \nsex : Female Male \nchronic_disease_flag : No Yes \nchronic_disease_v3 : None Thyroidism Other Blood Heart Stomach Depression Pain \nmeds_flag : No Yes \nsupplements_flag : No Yes \n\n\n\n\nPartial Dependence Plots\n\n\n\n\n\n\n\n\nFigure 82: Effect of age. U-shaped average effect on Taurine concentration. Young and old subjects exhibit an increase in Taurine concentration with the pace of increase being stronger for older subjects.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 83: Effect of aerobics training. Spending more time on aerobics training seems to increase levels of Taurine concentration, but at a relatively slow pace. The effect is more prominent from no resistance training to about 3 hours per week i.e. 180/60\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 84: Effect of supplements intake. Taking supplenents increase the Taurine concentration but the difference from non-takers is not significant.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 85: Effect of sex. No difference between males and females.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 86: Simultaneous effects of supplement intake and age. Individuals who are either old and do not take any supplements or who are young and do take supplements have higher levels of Taurine concentration.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 87: Simultaneous effects of supplement intake and sex. Males who do take supplements have higher levels of Taurine concentration.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 88: Simultaneous effects of supplement intake and aerobics_activity. Individuals who do not follow an aerobic activity but take supplements tend to have higher levels of Taurine concentration.\n\n\n\n\n\n\n\nValidation & Calibration\nTo assess model performance, a validation and calibration analysis is conducted below as with other amino acids. Below are results from the validation analysis using bootstrapping as the resampling technique. The algorithm can be described as follows source:\n\nEstimate model performance in the original sample of size n\nDraw a bootstrap sample of the same size n and fit the model to the bootstrap sample\nApply the model obtained in the bootstrap sample to the original sample\nSubtract the accuracy measure found in the bootstrap sample from the accuracy measure in the original sample - this is the estimate of optimism (i.e. overfitting)\nRepeat the process many times (e.g. 300) and average over the repeats to obtain a final estimate of optimism for each measure\nSubtract that value from the observed/apparent accuracy measure to get the optimism corrected estimate\n\n\n\n\n\n2nd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.06\n\n\n0.1\n\n\n0.02\n\n\n0.08\n\n\n-0.02\n\n\n300\n\n\n\n\nMSE\n\n\n0.88\n\n\n0.84\n\n\n0.92\n\n\n-0.08\n\n\n0.96\n\n\n300\n\n\n\n\n\\(g\\)\n\n\n0.27\n\n\n0.33\n\n\n0.22\n\n\n0.12\n\n\n0.15\n\n\n300\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n2.28\n\n\n-2.28\n\n\n2.28\n\n\n300\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.65\n\n\n0.35\n\n\n0.65\n\n\n300\n\n\n\n\n\n\n\n\nn=241   Mean absolute error=0.059   Mean squared error=0.00485\n0.9 Quantile of absolute error=0.101\n\n\n\n\n\n\n\n\nFigure 89: Calibration plot for 2nd pass model. Deviation from the diagonal line after correcting for overfitting or bias. The larger deviations occur to the right of the plot which means that the model has some tendency to overestimate the true Taurine concentration value i.e. if the model predicts exp(7) = 1000 μmol/g, then actual is 1000*exp(mae=-0.059) = 943 μmol/g ~ exp(6.8)\n\n\n\n\n\n\n\nDynamic Reference Intervals\nThe following table shows an example of the construction of a 95% reference interval (RI) for each of four subjects with specific covariate values. For the 2nd pass model only age, supplements_flag, aerobics_activity and sex make a difference since the rest of the covariates are not used.\n\n\n\n  \n\n\n\nThe RI for Taurine from Mayo Clinic Laboratories for ages above 18 years is 24 to 1560 μmol/g of creatinine.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---1st-pass-5",
    "href": "modeling_110624.html#model---1st-pass-5",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 1st Pass",
    "text": "Model - 1st Pass\nTest for non-linear relationships between each covariate and the amino acid concentration is executed below. This helps in deciding whether to model an association in a non-linear fashion i.e. with a polynomial term or a spline term or an interaction, or to just consider the covariates separately and without any special transformation.\n\n\n\n\n\n\n\n\nFigure 90: Spearman’s test for assessing non-linear relationships with the response. The further away from 0 the adjusted \\(\\rho^2\\) score is, the higher the degree of non-linearity for that covariate.\n\n\n\n\n\nNon-linearity evident in chronic_disease_v3, age, sex, bmi and aerobics_activity (smaller \\(\\rho^2\\) with opposite sign). Most \\(\\rho^2\\) values are relatively small.\nTo capture non linearities, interactions amongst these 5 variables will be considered, as well as spline transformations. The model achieving the best global significance (p-value = 0.0487) contained the following terms:\nlog(Isoleucine) ~ sex + rcs(age,3) + bmi + chronic_disease_v3 + sex:rcs(age,3)\nWhere the : symbol denotes the interaction between two variables and rcs denotes a restricted cubic spline transformation with 3 knots.\nSince this is a 1st pass for the model, with a view to detect outliers, more details and characteristics of the model are shown below when the 2nd pass is undertaken.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#outlier-analysis-based-on-model-residuals-5",
    "href": "modeling_110624.html#outlier-analysis-based-on-model-residuals-5",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Outlier analysis based on model residuals",
    "text": "Outlier analysis based on model residuals\nWhen assessing the residuals from the model fit using a normal probability plot, we see the presence of large residuals i.e. difference of the observed and predicted values. These residuals correspond to model predictions that produced larger errors than the bulk of the data. They are indicative of cases that can’t be explained well by the model (i.e. missing covariate information, prediction extrapolation from unseen by the model covariate values etc), and as such can be cast as outliers. This is also appropriate in terms of developing a model that will be used for reference interval construction i.e. cases foreign to the model should fall outside the reference interval and flagged both as inconclusive and for further inspection.\n\n\n------------------------------------------------------------------------------ \nResidual Distribution - Isoleucine Model\n\n  length      n        NAs  unique    0s   mean  meanCI'\n     308    217         91     = n     0  -0.00   -0.08\n          70.5%      29.5%          0.0%           0.08\n                                                       \n     .05    .10        .25  median   .75    .90     .95\n   -0.84  -0.64      -0.30   -0.03  0.28   0.71    1.16\n                                                       \n   range     sd      vcoef     mad   IQR   skew    kurt\n    4.45   0.58  -5.82e+15    0.43  0.58   0.05    1.83\n                                                       \nlowest : -2.52, -1.47, -1.28, -1.23, -1.19\nhighest: 1.33, 1.36, 1.37, 1.49, 1.93\n\n' 95%-CI (classic)\n\n\n\n\n\n\n\n\nFigure 91: Figure combining a histogram with a density plot, a boxplot and the plot of the empirical distribution function (ECDF). The scale for the x-axis is synchronized over all plots. The median can be found on the boxplot as also in the ecdf-plot. The maximum and the minimum value are tagged with a tiny vertical dash upon the ecdf-line. The mean is shown in the boxplot as grey cross, the grey bar is its confidence interval.\n\n\n\n\n\nIn comparison to the previous outlier analysis as seen here, the difference now is that the analysis is conducted on the model residuals, hence on values that are conditional on meta data (predictor variables) whereas previously the analysis was marginally or unconditionally executed with the only assumption being that of the amino acid concentration following a log-normal distribution.\nFigure 92 shows a quantile-quantile plot where the quantiles of the model’s residual values are matched to the ones predicted from a normal distribution. The diagonal line indicates the ideal fit. Data points marked in red denote outliers (also indicated in the table below each plot with their corresponding subject IDs).\nFor the rest of the figures below (i.e. for other amino acids), the same outlier detection procedure is applied but with a different parameterization which controls the outlier detection thresholds (i.e. horizontal lines in plot).\n\n\n\n\n\n\n\n\nFigure 92: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutliers\n\n\nSubject id1\nIsoleucine2\n\n\n\n\n40691\n−2.52\n\n\n39975\n1.93\n\n\n\n1 Red coloured data points in above QQ plot\n\n\n2 μmol/g (model residual)",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---2nd-pass-5",
    "href": "modeling_110624.html#model---2nd-pass-5",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 2nd Pass",
    "text": "Model - 2nd Pass\nHere the model is refitted to the data excluding the outlier values detected in the previous step. The model formula is the same with the only difference that now 3 knots are used for the spline transformations instead of 4 previous, since 3 knots gave a better global regression significance (p-value = 0.0112).\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 93: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed weak outliers (the strong ones detected by the 1st pass model have been removed).\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 94: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 95: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Isoleucine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nage\n\n\n34.0\n\n\n53.0\n\n\n19.0\n\n\n0.140000\n\n\n0.14600\n\n\n-0.147800\n\n\n0.42790\n\n\n\n\nbmi\n\n\n22.8\n\n\n29.3\n\n\n6.5\n\n\n0.096760\n\n\n0.04975\n\n\n-0.001349\n\n\n0.19490\n\n\n\n\nsex — Male:Female\n\n\n1.0\n\n\n2.0\n\n\n\n\n-0.292800\n\n\n0.10700\n\n\n-0.503900\n\n\n-0.08180\n\n\n\n\nchronic_disease_v3 — Thyroidism:None\n\n\n1.0\n\n\n2.0\n\n\n\n\n-0.104700\n\n\n0.11710\n\n\n-0.335600\n\n\n0.12630\n\n\n\n\nchronic_disease_v3 — Other:None\n\n\n1.0\n\n\n3.0\n\n\n\n\n0.026270\n\n\n0.13670\n\n\n-0.243300\n\n\n0.29580\n\n\n\n\nchronic_disease_v3 — Blood:None\n\n\n1.0\n\n\n4.0\n\n\n\n\n0.001275\n\n\n0.17790\n\n\n-0.349600\n\n\n0.35220\n\n\n\n\nchronic_disease_v3 — Heart:None\n\n\n1.0\n\n\n5.0\n\n\n\n\n-0.331800\n\n\n0.18660\n\n\n-0.699800\n\n\n0.03611\n\n\n\n\nchronic_disease_v3 — Stomach:None\n\n\n1.0\n\n\n6.0\n\n\n\n\n-0.298500\n\n\n0.18380\n\n\n-0.661000\n\n\n0.06398\n\n\n\n\nchronic_disease_v3 — Depression:None\n\n\n1.0\n\n\n7.0\n\n\n\n\n0.065230\n\n\n0.25170\n\n\n-0.431000\n\n\n0.56150\n\n\n\n\nchronic_disease_v3 — Pain:None\n\n\n1.0\n\n\n8.0\n\n\n\n\n0.369200\n\n\n0.28170\n\n\n-0.186300\n\n\n0.92470\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 96: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---3rd-pass-3",
    "href": "modeling_110624.html#model---3rd-pass-3",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 3rd Pass",
    "text": "Model - 3rd Pass\nThe 2nd pass model uses too many degrees of freedom (df) in relation to the size of the data i.e. 14 df should be spent instead of the 16 from the model. This can be seen by conducting a validation and calibration analysis. Below are results from the validation analysis using bootstrapping as the resampling technique. The algorithm can be described as follows source:\n\nEstimate model performance in the original sample of size n\nDraw a bootstrap sample of the same size n and fit the model to the bootstrap sample\nApply the model obtained in the bootstrap sample to the original sample\nSubtract the accuracy measure found in the bootstrap sample from the accuracy measure in the original sample - this is the estimate of optimism (i.e. overfitting)\nRepeat the process many times (e.g. 300) and average over the repeats to obtain a final estimate of optimism for each measure\nSubtract that value from the observed/apparent accuracy measure to get the optimism corrected estimate\n\n\n\n\n\n2nd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.13\n\n\n0.19\n\n\n0.06\n\n\n0.13\n\n\n0\n\n\n294\n\n\n\n\nMSE\n\n\n0.28\n\n\n0.26\n\n\n0.3\n\n\n-0.04\n\n\n0.32\n\n\n294\n\n\n\n\n\\(g\\)\n\n\n0.23\n\n\n0.27\n\n\n0.18\n\n\n0.09\n\n\n0.14\n\n\n294\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n0.82\n\n\n-0.82\n\n\n0.82\n\n\n294\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.68\n\n\n0.32\n\n\n0.68\n\n\n294\n\n\n\n\n\nFrom this table it can be seen that the optimism statistic which indicates the extent of model overfitting, for a variety of performance metrics has values that are large. Thus overfitting is present in the model.\nBy calibrating the predicted values from the model to the observed ones, we also notice a good amount of deviation from the diagonal line (ideal model performance) after correcting for this overfitting or bias.\n\n\n\nn=215   Mean absolute error=0.053   Mean squared error=0.00378\n0.9 Quantile of absolute error=0.088\n\n\n\n\n\n\n\n\nFigure 97: Calibration plot for 2nd pass model. Deviation from the diagonal line after correcting for overfitting or bias.\n\n\n\n\n\nThe 2nd pass model also includes the chronic_disease_v3 variable which contains categories with low frequencies in the data. As a result the effect size estimate is accompanied by a very large confidence interval. This renders the estimate as non-trustworthy.\nFrom these results and also the variable importance plot seen previously as well as the analysis of variance results, it looks like the variables, bmi, age and sex can be kept in a new model with less degree of freedom spending i.e. less overfitting the data.\nHence the model is refitted to the data with these just 3 covariates (Note: Situation might change when more data are collected and the model is refit).\nThe model formula is:\nlog(Isoleucine) ~ sex + rcs(age,4) + bmi + sex:rcs(age,4)\nand in expanded form:\n\n\n[1] 2.811 + 0.1004*(sex==Male) - 0.02095* age + 3.068e - 05*pmax(age - 20,0)^3 - 0.0001547*pmax(age - 38,0)^3 + 0.0001624*pmax(age - 48,0)^3 - 3.842e - 05*pmax(age - 65.9,0)^3 + 0.01476*bmi + (sex==Male)*( - 0.01437* age + 1.659e - 05*pmax(age - 20,0)^3 - 9.307e - 06*pmax(age - 38,0)^3 - 2.802e - 05*pmax(age - 48,0)^3 + 2.075e - 05*pmax(age - 65.9,0)^3)\n\n\nThe model’s reference values can be seen below in the row named Adjust to:\n\n\n                   id    sex age  bmi chronic_disease_flag chronic_disease_v3 meds_flag supplements_flag aerobics_activity resistance_activity Isoleucine\nLow:effect       &lt;NA&gt;   &lt;NA&gt;  34 22.8                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                 0                   0   8.613333\nAdjust to       24486 Female  43 25.3                   No               None        No               No                 0                   0  12.934764\nHigh:effect      &lt;NA&gt;   &lt;NA&gt;  53 29.3                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                60                 540  18.467093\nLow:prediction   1018 Female  11 16.6                   No               None        No               No                 0                   0   1.525990\nHigh:prediction NAKOS   Male  80 46.2                  Yes               Pain       Yes              Yes               720                 540  63.475868\nLow              1018 Female  11 16.6                   No               None        No               No                 0                   0   1.525990\nHigh            NAKOS   Male  80 46.2                  Yes               Pain       Yes              Yes               720                 540  63.475868\n\nValues:\n\nid : 1018 10985 1210 1219 1326 1338 1378 162 1623 1960 2024_1 2024_10 2024_11 2024_12 2024_2 2024_3 2024_4 2024_5 2024_6 2024_7 + 294 others \nsex : Female Male \nchronic_disease_flag : No Yes \nchronic_disease_v3 : None Thyroidism Other Blood Heart Stomach Depression Pain \nmeds_flag : No Yes \nsupplements_flag : No Yes \n\n\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 98: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers. Here the algorithm reports outliers due to its parameterization, however these are weak outliers since their deviation from the straight line is not large.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 99: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 100: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Isoleucine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nage\n\n\n34.0\n\n\n53.0\n\n\n19.0\n\n\n0.11860\n\n\n0.14110\n\n\n-0.159700\n\n\n0.3968\n\n\n\n\nbmi\n\n\n22.8\n\n\n29.3\n\n\n6.5\n\n\n0.09597\n\n\n0.04919\n\n\n-0.001017\n\n\n0.1930\n\n\n\n\nsex — Male:Female\n\n\n1.0\n\n\n2.0\n\n\n\n\n-0.31670\n\n\n0.10470\n\n\n-0.523200\n\n\n-0.1102\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 101: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.\n\n\n\n\n\n\n\nPartial Dependence Plots\n\n\n\n\n\n\n\n\nFigure 102: Linear effect of bmi. Isoleucine concentration levels can be seen to increase with increasing bmi.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 103: Nonlinear effect of age. Age is seen to decrease the levels of Isoleucine concentration particularly for the below 30 and above 60 years subgroups.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 104: Effect of sex. Females have higher levels of Isoleucine concentration.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 105: Simultaneous effects of bmi and age. Isoleucine concentration levels are seen to increase with increasing bmi and decreasing age.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 106: Simultaneous effects of sex and age. Males are shown to have higher Isoleucine concentration levels at old age (above 60) compared to females.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 107: Simultaneous effects of sex and bmi. As the bmi increases, Isoleucine concentration levels increase at a higher level for females than for males.\n\n\n\n\n\n\n\nValidation & Calibration\n\n\n\n\n3rd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.09\n\n\n0.13\n\n\n0.05\n\n\n0.08\n\n\n0.01\n\n\n300\n\n\n\n\nMSE\n\n\n0.29\n\n\n0.28\n\n\n0.3\n\n\n-0.03\n\n\n0.31\n\n\n300\n\n\n\n\n\\(g\\)\n\n\n0.19\n\n\n0.22\n\n\n0.16\n\n\n0.06\n\n\n0.13\n\n\n300\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n0.65\n\n\n-0.65\n\n\n0.65\n\n\n300\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.75\n\n\n0.25\n\n\n0.75\n\n\n300\n\n\n\n\n\nWe note also that the successful number of resamples is 300 (i.e. the number of bootstrap samples that we have chosen to perform the validation). In contrast, the 2nd pass model did not use all of the 300 resamples due to divergence or singularity issues which occurred in 6 samples, and thus left 294 resamples to use for the validation. These divergence issues were due to reasons such as missing values, categories of the chronic_disease_v3 variable with a low frequency and the complexity of the model.\nIn addition this 3rd pass model has used only 215 individuals from the current pool of 308 due the many zero or non-detection cases in the data.\n\n\n\nn=215   Mean absolute error=0.044   Mean squared error=0.00276\n0.9 Quantile of absolute error=0.08\n\n\n\n\n\n\n\n\nFigure 108: Calibration plot for 3rd pass model. Deviation from the diagonal line after correcting for overfitting or bias. It can be seen that deviations have been reduced compared to the 2nd pass model, especially on the left side where underestimation is the issue. On the right part overestimation can be observed that has not been eliminated in comparison to the 2nd pass model. This is perhaps due to the currently small sample size of 215 individuals upon which the models have been built.\n\n\n\n\n\n\n\nDynamic Reference Intervals\nThe following table shows an example of the construction of a 95% reference interval (RI) for each of four subjects with specific covariate values. For the 3rd pass model only bmi, age and sex make a difference since the rest of the covariates are not used.\n\n\n\n  \n\n\n\nThe RI for Isoleucine from Mayo Clinic Laboratories for ages above 18 years is less than 22 μmol/g of creatinine.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---1st-pass-6",
    "href": "modeling_110624.html#model---1st-pass-6",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 1st Pass",
    "text": "Model - 1st Pass\nTest for non-linear relationships between each covariate and the amino acid concentration is executed below. This helps in deciding whether to model an association in a non-linear fashion i.e. with a polynomial term or a spline term or an interaction, or to just consider the covariates separately and without any special transformation.\n\n\n\n\n\n\n\n\nFigure 109: Spearman’s test for assessing non-linear relationships with the response. The further away from 0 the adjusted \\(\\rho^2\\) score is, the higher the degree of non-linearity for that covariate.\n\n\n\n\n\nNon-linearity evident in chronic_disease_v3, aerobics_activity, resistance_activity, bmi and age (smaller \\(\\rho^2\\) with opposite sign). Most \\(\\rho^2\\) values are relatively small.\nTo capture non linearities, interactions amongst these 5 variables will be considered, as well as spline transformations. The model achieving the best global significance (p-value = 0.0519) contained the following terms:\nlog(Leucine) ~ rcs(age,4) + rcs(bmi,4) + log(aerobics_activity+1) + log(resistance_activity+1) + chronic_disease_v3 + rcs(age,4):rcs(bmi,4) + rcs(age,4):log(aerobics_activity+1) + rcs(age,4):log(resistance_activity+1) + rcs(age,4):chronic_disease_v3 + rcs(bmi,4):log(aerobics_activity+1) + rcs(bmi,4):log(resistance_activity+1) + log(aerobics_activity+1):log(resistance_activity+1)\nWhere the : symbol denotes the interaction between two variables and rcs denotes a restricted cubic spline transformation with 3 knots.\nSince this is a 1st pass for the model, fairly complex and with a view to detect outliers, more details and characteristics of the model are shown below when the 2nd pass is undertaken. ## Outlier analysis based on model residuals\nWhen assessing the residuals from the model fit using a normal probability plot, we see the presence of large residuals i.e. difference of the observed and predicted values. These residuals correspond to model predictions that produced larger errors than the bulk of the data. They are indicative of cases that can’t be explained well by the model (i.e. missing covariate information, prediction extrapolation from unseen by the model covariate values etc), and as such can be cast as outliers. This is also appropriate in terms of developing a model that will be used for reference interval construction i.e. cases foreign to the model should fall outside the reference interval and flagged both as inconclusive and for further inspection.\n\n\n------------------------------------------------------------------------------ \nResidual Distribution - Leucine Model\n\n  length      n       NAs  unique    0s   mean  meanCI'\n     308    231        77     = n     0   0.00   -0.07\n          75.0%     25.0%          0.0%           0.07\n                                                      \n     .05    .10       .25  median   .75    .90     .95\n   -0.82  -0.56     -0.26    0.01  0.32   0.64    0.83\n                                                      \n   range     sd     vcoef     mad   IQR   skew    kurt\n    4.05   0.55  3.63e+15    0.44  0.58  -1.03    3.51\n                                                      \nlowest : -2.78, -1.96, -1.77, -1.71, -1.70\nhighest: 1.01, 1.03, 1.08, 1.21, 1.27\n\n' 95%-CI (classic)\n\n\n\n\n\n\n\n\nFigure 110: Figure combining a histogram with a density plot, a boxplot and the plot of the empirical distribution function (ECDF). The scale for the x-axis is synchronized over all plots. The median can be found on the boxplot as also in the ecdf-plot. The maximum and the minimum value are tagged with a tiny vertical dash upon the ecdf-line. The mean is shown in the boxplot as grey cross, the grey bar is its confidence interval.\n\n\n\n\n\nIn comparison to the previous outlier analysis as seen here, the difference now is that the analysis is conducted on the model residuals, hence on values that are conditional on meta data (predictor variables) whereas previously the analysis was marginally or unconditionally executed with the only assumption being that of the amino acid concentration following a log-normal distribution.\nFigure 111 shows a quantile-quantile plot where the quantiles of the model’s residual values are matched to the ones predicted from a normal distribution. The diagonal line indicates the ideal fit. Data points marked in red denote outliers (also indicated in the table below each plot with their corresponding subject IDs).\nFor the rest of the figures below (i.e. for other amino acids), the same outlier detection procedure is applied but with a different parameterization which controls the outlier detection thresholds (i.e. horizontal lines in plot).\n\n\n\n\n\n\n\n\nFigure 111: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutliers\n\n\nSubject id1\nLeucine2\n\n\n\n\n42534\n−2.78\n\n\n41757\n−1.71\n\n\n2024_7\n−1.43\n\n\n40282\n−1.77\n\n\n39756\n−1.70\n\n\n40030\n−1.96\n\n\n42021\n−1.38\n\n\n\n1 Red coloured data points in above QQ plot\n\n\n2 μmol/g (model residual)",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---2nd-pass-6",
    "href": "modeling_110624.html#model---2nd-pass-6",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 2nd Pass",
    "text": "Model - 2nd Pass\nHere the model is refitted to the data excluding the strong outlier values detected in the previous step. The model formula is the same as the 1st pass. The global regression significance is characterized by a p-value of 0.0187.\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 112: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed weak outliers (the strong ones detected by the 1st pass model have been removed).\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 113: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 114: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Leucine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nage\n\n\n34.00\n\n\n53.00\n\n\n19.00\n\n\n0.380400\n\n\n0.1917\n\n\n0.001882\n\n\n0.7589\n\n\n\n\nbmi\n\n\n22.78\n\n\n29.33\n\n\n6.55\n\n\n0.020530\n\n\n0.1388\n\n\n-0.253600\n\n\n0.2947\n\n\n\n\naerobics_activity\n\n\n0.00\n\n\n60.00\n\n\n60.00\n\n\n0.041220\n\n\n0.1345\n\n\n-0.224400\n\n\n0.3068\n\n\n\n\nresistance_activity\n\n\n0.00\n\n\n450.00\n\n\n450.00\n\n\n-0.211600\n\n\n0.2790\n\n\n-0.762500\n\n\n0.3394\n\n\n\n\nchronic_disease_v3 — Thyroidism:None\n\n\n1.00\n\n\n2.00\n\n\n\n\n-0.001054\n\n\n0.1462\n\n\n-0.289800\n\n\n0.2877\n\n\n\n\nchronic_disease_v3 — Other:None\n\n\n1.00\n\n\n3.00\n\n\n\n\n-0.023540\n\n\n0.1884\n\n\n-0.395500\n\n\n0.3484\n\n\n\n\nchronic_disease_v3 — Blood:None\n\n\n1.00\n\n\n4.00\n\n\n\n\n0.080100\n\n\n1.3830\n\n\n-2.650000\n\n\n2.8100\n\n\n\n\nchronic_disease_v3 — Heart:None\n\n\n1.00\n\n\n5.00\n\n\n\n\n0.378600\n\n\n0.3634\n\n\n-0.338900\n\n\n1.0960\n\n\n\n\nchronic_disease_v3 — Stomach:None\n\n\n1.00\n\n\n6.00\n\n\n\n\n0.011090\n\n\n0.3870\n\n\n-0.753100\n\n\n0.7752\n\n\n\n\nchronic_disease_v3 — Depression:None\n\n\n1.00\n\n\n7.00\n\n\n\n\n0.414500\n\n\n0.4004\n\n\n-0.376100\n\n\n1.2050\n\n\n\n\nchronic_disease_v3 — Pain:None\n\n\n1.00\n\n\n8.00\n\n\n\n\n0.881800\n\n\n1.3060\n\n\n-1.696000\n\n\n3.4600\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 115: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---3rd-pass-4",
    "href": "modeling_110624.html#model---3rd-pass-4",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 3rd Pass",
    "text": "Model - 3rd Pass\nThe 2nd pass model uses too many degrees of freedom (df) in relation to the size of the data i.e. 15 df should be spent instead of the 59 from the model. This can be seen by conducting a validation and calibration analysis. Below are results from the validation analysis using bootstrapping as the resampling technique. The algorithm can be described as follows source:\n\nEstimate model performance in the original sample of size n\nDraw a bootstrap sample of the same size n and fit the model to the bootstrap sample\nApply the model obtained in the bootstrap sample to the original sample\nSubtract the accuracy measure found in the bootstrap sample from the accuracy measure in the original sample - this is the estimate of optimism (i.e. overfitting)\nRepeat the process many times (e.g. 300) and average over the repeats to obtain a final estimate of optimism for each measure\nSubtract that value from the observed/apparent accuracy measure to get the optimism corrected estimate\n\n\n\n\n\n2nd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.31\n\n\n0.48\n\n\n-76.58\n\n\n77.06\n\n\n-76.75\n\n\n16\n\n\n\n\nMSE\n\n\n0.17\n\n\n0.12\n\n\n18.53\n\n\n-18.41\n\n\n18.57\n\n\n16\n\n\n\n\n\\(g\\)\n\n\n0.29\n\n\n0.37\n\n\n0.11\n\n\n0.26\n\n\n0.04\n\n\n16\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n2.4\n\n\n-2.4\n\n\n2.4\n\n\n16\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.25\n\n\n0.75\n\n\n0.25\n\n\n16\n\n\n\n\n\nFrom this table it can be seen that the optimism statistic which indicates the extent of model overfitting, for a variety of performance metrics has values that are large. Thus overfitting is present in the model.\nBy calibrating the predicted values from the model to the observed ones, we also notice a good amount of deviation from the diagonal line (ideal model performance) after correcting for this overfitting or bias.\n\n\n\nn=224   Mean absolute error=0.1   Mean squared error=0.01544\n0.9 Quantile of absolute error=0.216\n\n\n\n\n\n\n\n\nFigure 116: Calibration plot for 2nd pass model. Deviation from the diagonal line after correcting for overfitting or bias.\n\n\n\n\n\nThe 2nd pass model also includes the chronic_disease_v3 variable which contains categories with low frequencies in the data. As a result the effect size estimate is accompanied by a very large confidence interval. This renders the estimate as non-trustworthy.\nFrom these results and also the variable importance plot seen previously as well as the analysis of variance results, it looks like the variables age and resistance_activity are most important, with perhaps bmi and aerobics_activity included too. These variables can be kept in a new model with less degree of freedom spending i.e. less overfitting the data.\nHence the model is refitted to the data with these just 4 covariates (Note: Situation might change when more data are collected and the model is refit).\nThe model formula is:\nlog(Leucine) ~ rcs(age,4) + rcs(bmi,4) + log(resistance_activity+1) + rcs(age,4):log(resistance_activity+1) + log(aerobics_activity+1)\nwith a spending of 12 degrees of freedom.\nHowever, when examining the normal probability plot of this model’s residuals, the following is observed:\n\n\n\n\n\n\n\n\nFigure 117: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers. At this stage of the analysis, the algorithm rtypically eports weak outliers due to its parameterization. However, two strong outliers can be seen on the far right of the plot. These are strong because their deviation from the straight line is much larger than the rest of the cases.\n\n\n\n\n\nThere are two more strong outliers that remain. After removing these two data points, the model is then refit, with the same model formula as above and a global significance of 0.0021 (p-value).\nThe model formula is:\nlog(Leucine) ~ rcs(age,4) + rcs(bmi,4) + log(resistance_activity+1) + rcs(age,4):log(resistance_activity+1) + log(aerobics_activity+1)\nand in expanded form:\n\n\n[1] 3.343 - 0.02658*age + 3.097e-05*pmax(age-20,0)^3 - 0.0001252*pmax(age-38.4,0)^3 + 0.0001122*pmax(age-48,0)^3 - 1.799e-05*pmax(age-66.6,0)^3 + 0.02573*bmi - 0.00015*pmax(bmi - 19.72,0)^3 + 0.0003447*pmax(bmi - 23.98,0)^3 - 2e-04*pmax(bmi - 27.5,0)^3 + 5.29e-06*pmax(bmi - 36.8,0)^3 - 0.2972*resistance_activity + 0.003623*aerobics_activity + resistance_activity*(0.01006*age - 1.572e-05*pmax(age-20,0)^3 + 7.705e-05*pmax(age-38.4,0)^3 - 7.742e-05*pmax(age-48,0)^3 + 1.61e-05*pmax(age-66.6,0)^3)\n\n\nThe model’s reference values can be seen below in the row named Adjust to:\n\n\n                   id    sex age    bmi chronic_disease_flag chronic_disease_v3 meds_flag supplements_flag aerobics_activity resistance_activity    Leucine\nLow:effect       &lt;NA&gt;   &lt;NA&gt;  34 22.725                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                 0                   0 16.9232771\nAdjust to       24486 Female  43 25.400                   No               None        No               No                 0                   0 23.6036810\nHigh:effect      &lt;NA&gt;   &lt;NA&gt;  53 29.375                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                60                 450 33.3190826\nLow:prediction   1018 Female  11 16.600                   No               None        No               No                 0                   0  0.6378491\nHigh:prediction NAKOS   Male  80 46.200                  Yes               Pain       Yes              Yes               720                 450 79.7028619\nLow              1018 Female  11 16.600                   No               None        No               No                 0                   0  0.6378491\nHigh            NAKOS   Male  80 46.200                  Yes               Pain       Yes              Yes               720                 450 79.7028619\n\nValues:\n\nid : 1018 10985 1210 1219 1326 1338 1378 162 1623 1960 2024_1 2024_10 2024_11 2024_12 2024_2 2024_3 2024_4 2024_5 2024_6 2024_8 + 287 others \nsex : Female Male \nchronic_disease_flag : No Yes \nchronic_disease_v3 : None Thyroidism Other Blood Heart Stomach Depression Pain \nmeds_flag : No Yes \nsupplements_flag : No Yes \n\n\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 118: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers. Here the algorithm reports outliers due to its parameterization, however these are weak outliers since their deviation from the straight line is not large.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 119: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 120: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Leucine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nage\n\n\n34.00\n\n\n53.00\n\n\n19.00\n\n\n0.14750\n\n\n0.09917\n\n\n-0.04798\n\n\n0.34300\n\n\n\n\nbmi\n\n\n22.72\n\n\n29.37\n\n\n6.65\n\n\n0.09335\n\n\n0.08260\n\n\n-0.06948\n\n\n0.25620\n\n\n\n\nresistance_activity\n\n\n0.00\n\n\n450.00\n\n\n450.00\n\n\n-0.29440\n\n\n0.12950\n\n\n-0.54970\n\n\n-0.03909\n\n\n\n\naerobics_activity\n\n\n0.00\n\n\n60.00\n\n\n60.00\n\n\n0.01490\n\n\n0.06229\n\n\n-0.10790\n\n\n0.13770\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 121: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.\n\n\n\n\n\n\n\nPartial Dependence Plots\n\n\n\n\n\n\n\n\nFigure 122: Linear effect of bmi. Leucine concentration levels can be seen to increase with increasing bmi.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 123: Nonlinear effect of age. Age is seen to decrease the levels of Leucine concentration particularly for the below 30 years subgroup.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 124: Effect of resistance training. Leucine concentration decreases with increasing weekly duration of resistance training.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 125: No particular effect of aerobics training on levels of Leucine concentration.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 126: Simultaneous effects of age and resistance_activity. Leucine concentration levels are seen to increase with increasing both age and weekly resistance training duration.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 127: Simultaneous effects of age and bmi. Leucine concentration levels are seen to increase with decreasing age and increasing bmi.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 128: Simultaneous effects of bmi and resistance_activity. Leucine concentration levels are seen to increase with increasing bmi and decreasing weekly resistance training duration.\n\n\n\n\n\n\n\nValidation & Calibration\n\n\n\n\n3rd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.12\n\n\n0.16\n\n\n0.08\n\n\n0.08\n\n\n0.04\n\n\n300\n\n\n\n\nMSE\n\n\n0.2\n\n\n0.19\n\n\n0.21\n\n\n-0.02\n\n\n0.22\n\n\n300\n\n\n\n\n\\(g\\)\n\n\n0.18\n\n\n0.21\n\n\n0.16\n\n\n0.05\n\n\n0.14\n\n\n300\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n0.72\n\n\n-0.72\n\n\n0.72\n\n\n300\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.77\n\n\n0.23\n\n\n0.77\n\n\n300\n\n\n\n\n\nWe note also that the successful number of resamples is 300 (i.e. the number of bootstrap samples that we have chosen to perform the validation). In contrast, the 2nd pass model did not use all of the 300 resamples due to divergence or singularity issues which occurred in 284 samples, and thus left only 16 resamples to use for the validation. These divergence issues were due to reasons such as missing values, categories of the chronic_disease_v3 variable with a low frequency and the complexity of the model.\nIn addition this 3rd pass model has used only 222 individuals from the current pool of 308 due the many zero or non-detection cases in the data.\n\n\n\nn=222   Mean absolute error=0.042   Mean squared error=0.00233\n0.9 Quantile of absolute error=0.075\n\n\n\n\n\n\n\n\nFigure 129: Calibration plot for 3rd pass model. Deviation from the diagonal line after correcting for overfitting or bias. It can be seen that deviations have been reduced compared to the 2nd pass model, especially on the right side where overestimation is the issue. On the central-left part (between 2.9 and 3.1 predicted log scale) some underestimation can be observed that has not been eliminated in comparison to the 2nd pass model. This is perhaps due to the currently small sample size of 222 individuals upon which the model has been built.\n\n\n\n\n\n\n\nDynamic Reference Intervals\nThe following table shows an example of the construction of a 95% reference interval (RI) for each of four subjects with specific covariate values. For the 3rd pass model only age, bmi, resistance_activity and aerobics_activity make a difference since the rest of the covariates are not used.\n\n\n\n  \n\n\n\nThe RI for Leucine from Mayo Clinic Laboratories for ages above 18 years is less than 51 μmol/g of creatinine.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---1st-pass-7",
    "href": "modeling_110624.html#model---1st-pass-7",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 1st Pass",
    "text": "Model - 1st Pass\nTest for non-linear relationships between each covariate and the amino acid concentration is executed below. This helps in deciding whether to model an association in a non-linear fashion i.e. with a polynomial term or a spline term or an interaction, or to just consider the covariates separately and without any special transformation.\n\n\n\n\n\n\n\n\nFigure 130: Spearman’s test for assessing non-linear relationships with the response. The further away from 0 the adjusted \\(\\rho^2\\) score is, the higher the degree of non-linearity for that covariate.\n\n\n\n\n\nNon-linearity evident in chronic_disease_v3, resistance_activity, sex, bmi (smaller \\(\\rho^2\\) with opposite sign) and age (smaller \\(\\rho^2\\) with opposite sign). Most \\(\\rho^2\\) values are relatively small.\nTo capture non linearities, interactions amongst these 5 variables will be considered, as well as spline transformations. The model achieving the best global significance (p-value = 0.0388) contained the following terms:\nlog(Glutamine) ~ sex + chronic_disease_v3 + log(resistance_activity+1) + rcs(bmi,4) + rcs(age,4) + sex:log(resistance_activity+1) + sex:rcs(bmi,4) + sex:rcs(age,4) + chronic_disease_v3:log(resistance_activity+1)\nWhere the : symbol denotes the interaction between two variables and rcs denotes a restricted cubic spline transformation with 3 knots.\nSince this is a 1st pass for the model, fairly complex and with a view to detect outliers, more details and characteristics of the model are shown below when the 2nd pass is undertaken. ## Outlier analysis based on model residuals\nWhen assessing the residuals from the model fit using a normal probability plot, we see the presence of large residuals i.e. difference of the observed and predicted values. These residuals correspond to model predictions that produced larger errors than the bulk of the data. They are indicative of cases that can’t be explained well by the model (i.e. missing covariate information, prediction extrapolation from unseen by the model covariate values etc), and as such can be cast as outliers. This is also appropriate in terms of developing a model that will be used for reference interval construction i.e. cases foreign to the model should fall outside the reference interval and flagged both as inconclusive and for further inspection.\n\n\n------------------------------------------------------------------------------------------------------------------------------------------------------------------ \nResidual Distribution - Glutamine Model\n\n  length      n       NAs  unique    0s   mean  meanCI'\n     308    217        91     = n     0   0.00   -0.08\n          70.5%     29.5%          0.0%           0.08\n                                                      \n     .05    .10       .25  median   .75    .90     .95\n   -0.95  -0.77     -0.30    0.01  0.38   0.68    0.80\n                                                      \n   range     sd     vcoef     mad   IQR   skew    kurt\n    3.56   0.58  7.92e+15    0.53  0.68  -0.76    1.42\n                                                      \nlowest : -2.40, -2.25, -1.64, -1.56, -1.18\nhighest: 1.05, 1.05, 1.09, 1.15, 1.16\n\n' 95%-CI (classic)\n\n\n\n\n\n\n\n\nFigure 131: Figure combining a histogram with a density plot, a boxplot and the plot of the empirical distribution function (ECDF). The scale for the x-axis is synchronized over all plots. The median can be found on the boxplot as also in the ecdf-plot. The maximum and the minimum value are tagged with a tiny vertical dash upon the ecdf-line. The mean is shown in the boxplot as grey cross, the grey bar is its confidence interval.\n\n\n\n\n\nIn comparison to the previous outlier analysis as seen here, the difference now is that the analysis is conducted on the model residuals, hence on values that are conditional on meta data (predictor variables) whereas previously the analysis was marginally or unconditionally executed with the only assumption being that of the amino acid concentration following a log-normal distribution.\nFigure 132 shows a quantile-quantile plot where the quantiles of the model’s residual values are matched to the ones predicted from a normal distribution. The diagonal line indicates the ideal fit. Data points marked in red denote outliers (also indicated in the table below each plot with their corresponding subject IDs).\nFor the rest of the figures below (i.e. for other amino acids), the same outlier detection procedure is applied but with a different parameterization which controls the outlier detection thresholds (i.e. horizontal lines in plot).\n\n\n\n\n\n\n\n\nFigure 132: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutliers\n\n\nSubject id1\nGlutamine2\n\n\n\n\n41757\n−1.56\n\n\n40691\n−2.40\n\n\n39948\n−2.25\n\n\n42021\n−1.64\n\n\n39942\n1.16\n\n\n39788\n1.15\n\n\n\n1 Red coloured data points in above QQ plot\n\n\n2 μmol/g (model residual)",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---2nd-pass-7",
    "href": "modeling_110624.html#model---2nd-pass-7",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 2nd Pass",
    "text": "Model - 2nd Pass\nHere the model is refitted to the data excluding the strong outlier values detected in the previous step. The model formula is the same as the 1st pass. The global regression significance is characterized by a p-value of 0.0038.\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 133: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed weak outliers (the strong ones detected by the 1st pass model have been removed).\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 134: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 135: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Glutamine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nresistance_activity\n\n\n0.0\n\n\n450.0\n\n\n450.0\n\n\n-0.07761\n\n\n0.1810\n\n\n-0.43470\n\n\n0.27950\n\n\n\n\nbmi\n\n\n22.8\n\n\n29.4\n\n\n6.6\n\n\n-0.07617\n\n\n0.1355\n\n\n-0.34340\n\n\n0.19110\n\n\n\n\nage\n\n\n34.0\n\n\n53.0\n\n\n19.0\n\n\n-0.12080\n\n\n0.1464\n\n\n-0.40960\n\n\n0.16810\n\n\n\n\nsex — Male:Female\n\n\n1.0\n\n\n2.0\n\n\n\n\n-0.35600\n\n\n0.1450\n\n\n-0.64210\n\n\n-0.06998\n\n\n\n\nchronic_disease_v3 — Thyroidism:None\n\n\n1.0\n\n\n2.0\n\n\n\n\n0.32920\n\n\n0.1393\n\n\n0.05442\n\n\n0.60410\n\n\n\n\nchronic_disease_v3 — Other:None\n\n\n1.0\n\n\n3.0\n\n\n\n\n0.35000\n\n\n0.1591\n\n\n0.03614\n\n\n0.66380\n\n\n\n\nchronic_disease_v3 — Blood:None\n\n\n1.0\n\n\n4.0\n\n\n\n\n0.31670\n\n\n0.2042\n\n\n-0.08614\n\n\n0.71960\n\n\n\n\nchronic_disease_v3 — Heart:None\n\n\n1.0\n\n\n5.0\n\n\n\n\n0.40540\n\n\n0.2390\n\n\n-0.06618\n\n\n0.87710\n\n\n\n\nchronic_disease_v3 — Stomach:None\n\n\n1.0\n\n\n6.0\n\n\n\n\n0.31300\n\n\n0.2546\n\n\n-0.18940\n\n\n0.81540\n\n\n\n\nchronic_disease_v3 — Depression:None\n\n\n1.0\n\n\n7.0\n\n\n\n\n-0.13910\n\n\n0.2821\n\n\n-0.69570\n\n\n0.41740\n\n\n\n\nchronic_disease_v3 — Pain:None\n\n\n1.0\n\n\n8.0\n\n\n\n\n0.69030\n\n\n0.5430\n\n\n-0.38110\n\n\n1.76200\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 136: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---3rd-pass-5",
    "href": "modeling_110624.html#model---3rd-pass-5",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 3rd Pass",
    "text": "Model - 3rd Pass\nThe 2nd pass model uses too many degrees of freedom (df) in relation to the size of the data i.e. 14 df should be spent instead of the 30 from the model. This can be seen by conducting a validation and calibration analysis. Below are results from the validation analysis using bootstrapping as the resampling technique. The algorithm can be described as follows source:\n\nEstimate model performance in the original sample of size n\nDraw a bootstrap sample of the same size n and fit the model to the bootstrap sample\nApply the model obtained in the bootstrap sample to the original sample\nSubtract the accuracy measure found in the bootstrap sample from the accuracy measure in the original sample - this is the estimate of optimism (i.e. overfitting)\nRepeat the process many times (e.g. 300) and average over the repeats to obtain a final estimate of optimism for each measure\nSubtract that value from the observed/apparent accuracy measure to get the optimism corrected estimate\n\n\n\n\n\n2nd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.22\n\n\n0.33\n\n\n0.07\n\n\n0.26\n\n\n-0.03\n\n\n142\n\n\n\n\nMSE\n\n\n0.25\n\n\n0.22\n\n\n0.3\n\n\n-0.08\n\n\n0.33\n\n\n142\n\n\n\n\n\\(g\\)\n\n\n0.29\n\n\n0.36\n\n\n0.23\n\n\n0.13\n\n\n0.16\n\n\n142\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n2.1\n\n\n-2.1\n\n\n2.1\n\n\n142\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.64\n\n\n0.36\n\n\n0.64\n\n\n142\n\n\n\n\n\nFrom this table it can be seen that the optimism statistic which indicates the extent of model overfitting, for a variety of performance metrics has values that are large. Thus overfitting is present in the model.\nBy calibrating the predicted values from the model to the observed ones, we also notice a good amount of deviation from the diagonal line (ideal model performance) after correcting for this overfitting or bias.\n\n\n\nn=211   Mean absolute error=0.048   Mean squared error=0.00549\n0.9 Quantile of absolute error=0.145\n\n\n\n\n\n\n\n\nFigure 137: Calibration plot for 2nd pass model. Deviation from the diagonal line after correcting for overfitting or bias.\n\n\n\n\n\nThe 2nd pass model also includes the chronic_disease_v3 variable which contains categories with low frequencies in the data. As a result the effect size estimate is accompanied by a very large confidence interval. This renders the estimate as non-trustworthy.\nFrom these results and also the variable importance plot seen previously as well as the analysis of variance results, it looks like the variables sex and chronic_disease_v3 are most important, with perhaps age, bmi and resistance_activity included too. These variables can be kept in a new model with less degree of freedom spending i.e. less overfitting the data.\nHence the model is refitted to the data including various combinations of these 5 covariates, with the chosen model spending just 13 degrees of freedom and having a global p-value equal to 0.0006.(Note: Situation might change when more data are collected and the model is refit).\nThe chosen model formula is:\nlog(Glutamine) ~ sex + chronic_disease_v3 + log(resistance_activity+1)+ rcs(age,4)\nand in expanded form:\n\n\n[1] 6.196 - 0.1921*(sex==Male) + 0.1539*(chronic_disease_v3==Thyroidism) + 0.1969*(chronic_disease_v3==Other) + 0.3008*(chronic_disease_v3==Blood) + 0.04866*(chronic_disease_v3==Heart) + 0.1676*(chronic_disease_v3==Stomach) - 0.5321*(chronic_disease_v3==Depression) - 0.2834*(chronic_disease_v3==Pain) - 0.04737*resistance_activity - 0.009526*age + 9.447e-06*pmax(age-20.35,0)^3 - 5.887e-05*pmax(age-39,0)^3 + 6.41e-05*pmax(age-48,0)^3 - 1.468e-05*pmax(age-66.3,0)^3\n\n\nThe model’s reference values can be seen below in the row named Adjust to:\n\n\n                   id    sex age  bmi chronic_disease_flag chronic_disease_v3 meds_flag supplements_flag aerobics_activity resistance_activity  Glutamine\nLow:effect       &lt;NA&gt;   &lt;NA&gt;  34 22.8                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                 0                   0  204.55233\nAdjust to       24486 Female  43 25.3                   No               None        No               No                 0                   0  325.30393\nHigh:effect      &lt;NA&gt;   &lt;NA&gt;  53 29.4                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                60                 450  494.34768\nLow:prediction   1018 Female  11 16.6                   No               None        No               No                 0                   0   27.14802\nHigh:prediction NAKOS   Male  80 46.2                  Yes               Pain       Yes              Yes               720                 450 1513.17950\nLow              1018 Female  11 16.6                   No               None        No               No                 0                   0   27.14802\nHigh            NAKOS   Male  80 46.2                  Yes               Pain       Yes              Yes               720                 450 1513.17950\n\nValues:\n\nid : 1018 10985 1210 1219 1326 1338 1378 162 1623 1960 2024_1 2024_10 2024_11 2024_12 2024_2 2024_3 2024_4 2024_5 2024_6 2024_7 + 290 others \nsex : Female Male \nchronic_disease_flag : No Yes \nchronic_disease_v3 : None Thyroidism Other Blood Heart Stomach Depression Pain \nmeds_flag : No Yes \nsupplements_flag : No Yes \n\n\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 138: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers. Here the algorithm does not report any weak outliers due to its parameterization i.e. outliers whose deviation from the straight line is not large.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 139: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 140: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Glutamine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nresistance_activity\n\n\n0\n\n\n450\n\n\n450\n\n\n-0.28950\n\n\n0.10360\n\n\n-0.49370\n\n\n-0.08533\n\n\n\n\nage\n\n\n34\n\n\n53\n\n\n19\n\n\n-0.02972\n\n\n0.10370\n\n\n-0.23410\n\n\n0.17470\n\n\n\n\nsex — Male:Female\n\n\n1\n\n\n2\n\n\n\n\n-0.19210\n\n\n0.07711\n\n\n-0.34400\n\n\n-0.04018\n\n\n\n\nchronic_disease_v3 — Thyroidism:None\n\n\n1\n\n\n2\n\n\n\n\n0.15390\n\n\n0.11130\n\n\n-0.06547\n\n\n0.37320\n\n\n\n\nchronic_disease_v3 — Other:None\n\n\n1\n\n\n3\n\n\n\n\n0.19690\n\n\n0.12370\n\n\n-0.04678\n\n\n0.44050\n\n\n\n\nchronic_disease_v3 — Blood:None\n\n\n1\n\n\n4\n\n\n\n\n0.30080\n\n\n0.17180\n\n\n-0.03767\n\n\n0.63920\n\n\n\n\nchronic_disease_v3 — Heart:None\n\n\n1\n\n\n5\n\n\n\n\n0.04866\n\n\n0.16730\n\n\n-0.28090\n\n\n0.37830\n\n\n\n\nchronic_disease_v3 — Stomach:None\n\n\n1\n\n\n6\n\n\n\n\n0.16760\n\n\n0.17610\n\n\n-0.17940\n\n\n0.51460\n\n\n\n\nchronic_disease_v3 — Depression:None\n\n\n1\n\n\n7\n\n\n\n\n-0.53210\n\n\n0.20250\n\n\n-0.93120\n\n\n-0.13310\n\n\n\n\nchronic_disease_v3 — Pain:None\n\n\n1\n\n\n8\n\n\n\n\n-0.28340\n\n\n0.23540\n\n\n-0.74720\n\n\n0.18040\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 141: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.\n\n\n\n\n\n\n\nPartial Dependence Plots\n\n\n\n\n\n\n\n\nFigure 142: Effect of sex. Glutamine concentration levels can be seen to be lower in females than in males.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 143: Nonlinear effect of age. Age is seen to decrease the levels of Glutamine concentration particularly for the higher than 60 years subgroup.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 144: Effect of resistance training. Glutamine concentration decreases with increasing weekly duration of resistance training.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 145: Effects of chronic disease type. No particular effect of aerobics training on levels of Glutamine concentration.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 146: Simultaneous effects of age and resistance_activity. Glutamine concentration levels are seen to increase with decreasing both age and weekly resistance training duration.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 147: Simultaneous effects of age and sex. Glutamine concentration levels are seen to increase with decreasing age, and being higher for females than for males.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 148: Simultaneous effects of sex and resistance_activity. Glutamine concentration levels are seen to increase with decreasing duration of weekly resistance training, and being higher for females than for males.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 149: Simultaneous effects of sex and chronic diseases. Blood type diseases have the highest Glutamine concentration, and with higher levels for females than for males.\n\n\n\n\n\n\n\nValidation & Calibration\n\n\n\n\n3rd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.13\n\n\n0.17\n\n\n0.08\n\n\n0.09\n\n\n0.04\n\n\n299\n\n\n\n\nMSE\n\n\n0.29\n\n\n0.28\n\n\n0.31\n\n\n-0.03\n\n\n0.32\n\n\n299\n\n\n\n\n\\(g\\)\n\n\n0.23\n\n\n0.26\n\n\n0.2\n\n\n0.06\n\n\n0.17\n\n\n299\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n1.32\n\n\n-1.32\n\n\n1.32\n\n\n299\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.77\n\n\n0.23\n\n\n0.77\n\n\n299\n\n\n\n\n\nWe note also that the successful number of resamples is 299 (i.e. the number of bootstrap samples that we have chosen to perform the validation). In contrast, the 2nd pass model did not use as many resamples due to divergence or singularity issues which occurred in 160 samples, and thus left only 142 resamples to use for the validation. These divergence issues were due to reasons such as missing values, categories of the chronic_disease_v3 variable with a low frequency and the complexity of the model.\nIn addition this 3rd pass model has used only 245 individuals from the current pool of 302 due the many zero or non-detection cases in the data.\n\n\n\nn=245   Mean absolute error=0.035   Mean squared error=0.00262\n0.9 Quantile of absolute error=0.099\n\n\n\n\n\n\n\n\nFigure 150: Calibration plot for 3rd pass model. Deviation from the diagonal line after correcting for overfitting or bias. It can be seen that deviations have been reduced compared to the 2nd pass model, especially on the left side where underestimation is the issue. On the right part (above the value of 6 on the predicted log scale) some overestimation can be observed that has not been eliminated in comparison to the 2nd pass model. This is perhaps due to the currently small sample size of 245 individuals upon which the model has been built.\n\n\n\n\n\n\n\nDynamic Reference Intervals\nThe following table shows an example of the construction of a 95% reference interval (RI) for each of four subjects with specific covariate values. For the 3rd pass model only age, sex, resistance_activity and chronic_disease_v3 make a difference since the rest of the covariates are not used.\n\n\n\n  \n\n\n\nThe RI for Glutamine from Mayo Clinic Laboratories for ages above 18 years is between 93 and 1290 μmol/g of creatinine.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---1st-pass-8",
    "href": "modeling_110624.html#model---1st-pass-8",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 1st Pass",
    "text": "Model - 1st Pass\nTest for non-linear relationships between each covariate and the amino acid concentration is executed below. This helps in deciding whether to model an association in a non-linear fashion i.e. with a polynomial term or a spline term or an interaction, or to just consider the covariates separately and without any special transformation.\n\n\n\n\n\n\n\n\nFigure 151: Spearman’s test for assessing non-linear relationships with the response. The further away from 0 the adjusted \\(\\rho^2\\) score is, the higher the degree of non-linearity for that covariate.\n\n\n\n\n\nNon-linearity evident in chronic_disease_v3 (smaller \\(\\rho^2\\) with opposite sign), sex, bmi (smaller \\(\\rho^2\\)), age (smaller \\(\\rho^2\\) with opposite sign) and aerobics_activity (smaller \\(\\rho^2\\) with opposite sign).\nTo capture non linearities, interactions amongst these 5 variables will be considered, as well as spline transformations. The model achieving the best global significance (p-value = 0.0216) contained the following terms:\nlog(Glutamate) ~ sex + chronic_disease_v3 + rcs(bmi,3) + rcs(age,4) + log(aerobics_activity+1) + sex:rcs(bmi,3) + sex:log(aerobics_activity+1) + rcs(bmi,3):rcs(age,4) + rcs(age,4):log(aerobics_activity+1)\nWhere the : symbol denotes the interaction between two variables and rcs denotes a restricted cubic spline transformation with 3 or 4 knots.\nSince this is a 1st pass for the model, fairly complex and with a view to detect outliers, more details and characteristics of the model are shown below when the 2nd pass is undertaken. ## Outlier analysis based on model residuals\nWhen assessing the residuals from the model fit using a normal probability plot, we see the presence of large residuals i.e. difference of the observed and predicted values. These residuals correspond to model predictions that produced larger errors than the bulk of the data. They are indicative of cases that can’t be explained well by the model (i.e. missing covariate information, prediction extrapolation from unseen by the model covariate values etc), and as such can be cast as outliers. This is also appropriate in terms of developing a model that will be used for reference interval construction i.e. cases foreign to the model should fall outside the reference interval and flagged both as inconclusive and for further inspection.\n\n\n------------------------------------------------------------------------------------------------------------------------------------------------------------------ \nResidual Distribution - Glutamate Model\n\n  length      n       NAs  unique    0s   mean  meanCI'\n     307    216        91     = n     0   0.00   -0.10\n          70.4%     29.6%          0.0%           0.10\n                                                      \n     .05    .10       .25  median   .75    .90     .95\n   -1.19  -0.92     -0.44    0.07  0.47   0.89    1.08\n                                                      \n   range     sd     vcoef     mad   IQR   skew    kurt\n    4.60   0.75  6.18e+15    0.67  0.91  -0.54    1.04\n                                                      \nlowest : -2.70, -2.49, -2.27, -2.21, -2.01\nhighest: 1.35, 1.50, 1.68, 1.86, 1.90\n\n' 95%-CI (classic)\n\n\n\n\n\n\n\n\nFigure 152: Figure combining a histogram with a density plot, a boxplot and the plot of the empirical distribution function (ECDF). The scale for the x-axis is synchronized over all plots. The median can be found on the boxplot as also in the ecdf-plot. The maximum and the minimum value are tagged with a tiny vertical dash upon the ecdf-line. The mean is shown in the boxplot as grey cross, the grey bar is its confidence interval.\n\n\n\n\n\nIn comparison to the previous outlier analysis as seen here, the difference now is that the analysis is conducted on the model residuals, hence on values that are conditional on meta data (predictor variables) whereas previously the analysis was marginally or unconditionally executed with the only assumption being that of the amino acid concentration following a log-normal distribution.\nFigure 153 shows a quantile-quantile plot where the quantiles of the model’s residual values are matched to the ones predicted from a normal distribution. The diagonal line indicates the ideal fit. Data points marked in red denote outliers (also indicated in the table below each plot with their corresponding subject IDs).\nFor the rest of the figures below (i.e. for other amino acids), the same outlier detection procedure is applied but with a different parameterization which controls the outlier detection thresholds (i.e. horizontal lines in plot).\n\n\n\n\n\n\n\n\nFigure 153: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nOutliers\n\n\nSubject id1\nGlutamate2\n\n\n\n\n42019\n−2.27\n\n\n42335\n−2.01\n\n\n41705\n−2.21\n\n\n41757\n−2.70\n\n\n40691\n−2.49\n\n\n\n1 Red coloured data points in above QQ plot\n\n\n2 μmol/g (model residual)",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---2nd-pass-8",
    "href": "modeling_110624.html#model---2nd-pass-8",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 2nd Pass",
    "text": "Model - 2nd Pass\nHere the model is refitted to the data excluding the strong outlier values detected in the previous step. The model formula is the same as the 1st pass. The global regression significance is characterized by a p-value of 0.0027.\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 154: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed weak outliers (the strong ones detected by the 1st pass model have been removed).\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 155: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 156: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Glutamate)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nbmi\n\n\n22.8\n\n\n29.3\n\n\n6.5\n\n\n-0.186300\n\n\n0.1183\n\n\n-0.4197\n\n\n0.04722\n\n\n\n\nage\n\n\n34.0\n\n\n53.0\n\n\n19.0\n\n\n0.158800\n\n\n0.2266\n\n\n-0.2881\n\n\n0.60580\n\n\n\n\naerobics_activity\n\n\n0.0\n\n\n60.0\n\n\n60.0\n\n\n-0.061510\n\n\n0.1381\n\n\n-0.3339\n\n\n0.21090\n\n\n\n\nsex — Male:Female\n\n\n1.0\n\n\n2.0\n\n\n\n\n-0.102000\n\n\n0.1590\n\n\n-0.4156\n\n\n0.21160\n\n\n\n\nchronic_disease_v3 — Thyroidism:None\n\n\n1.0\n\n\n2.0\n\n\n\n\n-0.104300\n\n\n0.1575\n\n\n-0.4150\n\n\n0.20630\n\n\n\n\nchronic_disease_v3 — Other:None\n\n\n1.0\n\n\n3.0\n\n\n\n\n0.224500\n\n\n0.1850\n\n\n-0.1404\n\n\n0.58940\n\n\n\n\nchronic_disease_v3 — Blood:None\n\n\n1.0\n\n\n4.0\n\n\n\n\n-0.099630\n\n\n0.2365\n\n\n-0.5663\n\n\n0.36700\n\n\n\n\nchronic_disease_v3 — Heart:None\n\n\n1.0\n\n\n5.0\n\n\n\n\n-0.248400\n\n\n0.2483\n\n\n-0.7382\n\n\n0.24150\n\n\n\n\nchronic_disease_v3 — Stomach:None\n\n\n1.0\n\n\n6.0\n\n\n\n\n-0.209300\n\n\n0.2403\n\n\n-0.6835\n\n\n0.26490\n\n\n\n\nchronic_disease_v3 — Depression:None\n\n\n1.0\n\n\n7.0\n\n\n\n\n0.180200\n\n\n0.3284\n\n\n-0.4677\n\n\n0.82820\n\n\n\n\nchronic_disease_v3 — Pain:None\n\n\n1.0\n\n\n8.0\n\n\n\n\n-0.009757\n\n\n0.3640\n\n\n-0.7279\n\n\n0.70840\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 157: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---3rd-pass-6",
    "href": "modeling_110624.html#model---3rd-pass-6",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 3rd Pass",
    "text": "Model - 3rd Pass\nThe 2nd pass model uses too many degrees of freedom (df) in relation to the size of the data i.e. 14 df should be spent instead of the 27 from the model. This can be seen by conducting a validation and calibration analysis. Below are results from the validation analysis using bootstrapping as the resampling technique. The algorithm can be described as follows source:\n\nEstimate model performance in the original sample of size n\nDraw a bootstrap sample of the same size n and fit the model to the bootstrap sample\nApply the model obtained in the bootstrap sample to the original sample\nSubtract the accuracy measure found in the bootstrap sample from the accuracy measure in the original sample - this is the estimate of optimism (i.e. overfitting)\nRepeat the process many times (e.g. 300) and average over the repeats to obtain a final estimate of optimism for each measure\nSubtract that value from the observed/apparent accuracy measure to get the optimism corrected estimate\n\n\n\n\n\n2nd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.21\n\n\n0.3\n\n\n0.07\n\n\n0.23\n\n\n-0.02\n\n\n292\n\n\n\n\nMSE\n\n\n0.43\n\n\n0.38\n\n\n0.51\n\n\n-0.13\n\n\n0.56\n\n\n292\n\n\n\n\n\\(g\\)\n\n\n0.37\n\n\n0.44\n\n\n0.29\n\n\n0.15\n\n\n0.22\n\n\n292\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n1.09\n\n\n-1.09\n\n\n1.09\n\n\n292\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.63\n\n\n0.37\n\n\n0.63\n\n\n292\n\n\n\n\n\nFrom this table it can be seen that the optimism statistic which indicates the extent of model overfitting, for a variety of performance metrics has values that are large. Thus overfitting is present in the model.\nBy calibrating the predicted values from the model to the observed ones, we also notice a good amount of deviation from the diagonal line (ideal model performance) after correcting for this overfitting or bias.\n\n\n\nn=211   Mean absolute error=0.092   Mean squared error=0.01141\n0.9 Quantile of absolute error=0.163\n\n\n\n\n\n\n\n\nFigure 158: Calibration plot for 2nd pass model. Deviation from the diagonal line after correcting for overfitting or bias.\n\n\n\n\n\nThe 2nd pass model also includes the chronic_disease_v3 variable which contains categories with low frequencies in the data. As a result the effect size estimate is accompanied by a very large confidence interval. This renders the estimate as non-trustworthy.\nFrom these results and also the variable importance plot seen previously as well as the analysis of variance results, it looks like the variables age, bmi, sex and aerobics_activity are most important. These variables can be kept in a new model with less degree of freedom spending i.e. less overfitting the data.\nHence the model is refitted to the data including various combinations of these 4 covariates, with the chosen model spending just 5 degrees of freedom and having a global p-value equal to 0.0073.(Note: Situation might change when more data are collected and the model is refit).\nThe chosen model formula is:\nlog(Glutamate) ~ sex + bmi + age + log(aerobics_activity+1)\nand in expanded form:\n\n\n[1] 3.085 - 0.38*(sex==Male) - 0.001491*bmi + 0.0007562*age + 0.00484*aerobics_activity\n\n\nThe model’s reference values can be seen below in the row named Adjust to:\n\n\n                   id    sex age  bmi chronic_disease_flag chronic_disease_v3 meds_flag supplements_flag aerobics_activity resistance_activity  Glutamate\nLow:effect       &lt;NA&gt;   &lt;NA&gt;  34 22.8                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                 0                   0  11.699476\nAdjust to       24486 Female  43 25.3                   No               None        No               No                 0                   0  19.796758\nHigh:effect      &lt;NA&gt;   &lt;NA&gt;  53 29.3                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                60                 450  35.321746\nLow:prediction   1018 Female  11 16.6                   No               None        No               No                 0                   0   1.361611\nHigh:prediction NAKOS   Male  80 46.2                  Yes               Pain       Yes              Yes               720                 450 210.959504\nLow              1018 Female  11 16.6                   No               None        No               No                 0                   0   1.361611\nHigh            NAKOS   Male  80 46.2                  Yes               Pain       Yes              Yes               720                 450 210.959504\n\nValues:\n\nid : 1018 10985 1210 1219 1326 1338 1378 162 1623 1960 2024_1 2024_10 2024_11 2024_12 2024_2 2024_3 2024_4 2024_5 2024_6 2024_7 + 290 others \nsex : Female Male \nchronic_disease_flag : No Yes \nchronic_disease_v3 : None Thyroidism Other Blood Heart Stomach Depression Pain \nmeds_flag : No Yes \nsupplements_flag : No Yes \n\n\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 159: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers. Here the algorithm does not report any weak outliers due to its parameterization i.e. outliers whose deviation from the straight line is not large.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 160: Plot of predictions vs model residuals. It can be seen that predictions are separated into two groups. This is due to the large influence of the sex covariate (seen in the next section) on the Glutamate concentration levels. Besides this, no other patterns can be observed.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 161: Proportion of overall model \\(R^2\\) that is due to each predictor. Large influence of the sex covariate. The rest of the covariates are currently kept in the model as with new data their impact might positively change.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Glutamate)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nbmi\n\n\n22.8\n\n\n29.3\n\n\n6.5\n\n\n-0.009689\n\n\n0.06390\n\n\n-0.1357\n\n\n0.1163\n\n\n\n\nage\n\n\n34.0\n\n\n53.0\n\n\n19.0\n\n\n0.014370\n\n\n0.07312\n\n\n-0.1298\n\n\n0.1585\n\n\n\n\naerobics_activity\n\n\n0.0\n\n\n60.0\n\n\n60.0\n\n\n0.019900\n\n\n0.08887\n\n\n-0.1553\n\n\n0.1951\n\n\n\n\nsex — Male:Female\n\n\n1.0\n\n\n2.0\n\n\n\n\n-0.380000\n\n\n0.10370\n\n\n-0.5845\n\n\n-0.1756\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 162: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.\n\n\n\n\n\n\n\nPartial Dependence Plots\n\n\n\n\n\n\n\n\nFigure 163: Effect of sex. Glutamate concentration levels can be seen to be higher in females than in males.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 164: Linear effect of age. Age is seen to increase the levels of Glutamate concentration but at a very slow pace.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 165: No effect of aerobics training on Glutamate concentration levels.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 166: No effect of bmi on levels of Glutamate concentration.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 167: Simultaneous effects of age and aerobics_activity. Glutamate concentration levels are seen to increase on average with increasing both age and weekly aerobics training duration.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 168: Simultaneous effects of age and bmi. Glutamate concentration levels are seen to increase on average with decreasing bmi and increasing age.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 169: Simultaneous effects of bmi and aerobics training. Glutamate concentration levels are seen to increase on average with decreasing bmi and increasing duration of aerobics activity.\n\n\n\n\n\n\n\nValidation & Calibration\n\n\n\n\n3rd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.06\n\n\n0.08\n\n\n0.04\n\n\n0.04\n\n\n0.03\n\n\n300\n\n\n\n\nMSE\n\n\n0.51\n\n\n0.5\n\n\n0.52\n\n\n-0.02\n\n\n0.53\n\n\n300\n\n\n\n\n\\(g\\)\n\n\n0.19\n\n\n0.23\n\n\n0.19\n\n\n0.04\n\n\n0.15\n\n\n300\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n0.43\n\n\n-0.43\n\n\n0.43\n\n\n300\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.85\n\n\n0.15\n\n\n0.85\n\n\n300\n\n\n\n\n\nWe note also that the successful number of resamples is 300 (i.e. the number of bootstrap samples that we have chosen to perform the validation). In contrast, the 2nd pass model did not use as many resamples due to divergence or singularity issues which occurred in 10 samples, and thus left 292 resamples to use for the validation. These divergence issues were due to reasons such as missing values, categories of the chronic_disease_v3 variable with a low frequency and the complexity of the model.\nIn addition this 3rd pass model has used only 211 individuals from the current pool of 302 due the many zero or non-detection cases in the data.\n\n\n\nn=211   Mean absolute error=0.015   Mean squared error=3e-04\n0.9 Quantile of absolute error=0.028\n\n\n\n\n\n\n\n\nFigure 170: Calibration plot for 3rd pass model. Deviation from the diagonal line after correcting for overfitting or bias. It can be seen that deviations have been reduced compared to the 2nd pass model.\n\n\n\n\n\n\n\nDynamic Reference Intervals\nThe following table shows an example of the construction of a 95% reference interval (RI) for each of four subjects with specific covariate values. For the 3rd pass model only age, sex, aerobics_activity and bmi make a difference since the rest of the covariates are not used.\n\n\n\n  \n\n\n\nThe RI for Glutamate from Mayo Clinic Laboratories for ages above 18 years is less than 45 μmol/g of creatinine.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---1st-pass-9",
    "href": "modeling_110624.html#model---1st-pass-9",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 1st Pass",
    "text": "Model - 1st Pass\nTest for non-linear relationships between each covariate and the amino acid concentration is executed below. This helps in deciding whether to model an association in a non-linear fashion i.e. with a polynomial term or a spline term or an interaction, or to just consider the covariates separately and without any special transformation.\n\n\n\n\n\n\n\n\nFigure 171: Spearman’s test for assessing non-linear relationships with the response. The further away from 0 the adjusted \\(\\rho^2\\) score is, the higher the degree of non-linearity for that covariate.\n\n\n\n\n\nNon-linearity evident in chronic_disease_v3, resistance_activity, supplements_flag, bmi, age and aerobics_activity. Most \\(\\rho^2\\) values are small.\nTo capture non linearities, interactions amongst these 6 variables were considered without spline transformations. However, due to the above very low \\(\\rho^2\\) values and the lack of association with the Methionine concentration, it was difficult to obtain a model having global significance, even after testing various combinations of terms in the model. The model achieving the best global significance (p-value = 0.051) contained the following terms:\nlog(Methionine) ~ age + rcs(bmi,3) + age:rcs(bmi,3)\nWhere the : symbol denotes the interaction between two variables and rcs denotes a restricted cubic spline transformation with 3 knots. This model spends only 6 degrees of freedom.\nSince this is a 1st pass for the model with a view to detect outliers, more details and characteristics of the model are shown below when the 2nd pass is undertaken.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#outlier-analysis-based-on-model-residuals-6",
    "href": "modeling_110624.html#outlier-analysis-based-on-model-residuals-6",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Outlier analysis based on model residuals",
    "text": "Outlier analysis based on model residuals\nWhen assessing the residuals from the model fit using a normal probability plot, we see the presence of large residuals i.e. difference of the observed and predicted values. These residuals correspond to model predictions that produced larger errors than the bulk of the data. They are indicative of cases that can’t be explained well by the model (i.e. missing covariate information, prediction extrapolation from unseen by the model covariate values etc), and as such can be cast as outliers. This is also appropriate in terms of developing a model that will be used for reference interval construction i.e. cases foreign to the model should fall outside the reference interval and flagged both as inconclusive and for further inspection.\n\n\n------------------------------------------------------------------------------------------------------------------------------------------------------------------ \nResidual Distribution - Methionine Model\n\n  length      n       NAs  unique    0s  mean  meanCI'\n     304    227        77     = n     0  0.00   -0.08\n          74.7%     25.3%          0.0%          0.08\n                                                     \n     .05    .10       .25  median   .75   .90     .95\n   -0.89  -0.57     -0.28   -0.01  0.24  0.64    0.80\n                                                     \n   range     sd     vcoef     mad   IQR  skew    kurt\n    4.66   0.64  8.14e+15    0.39  0.52  0.55    4.19\n                                                     \nlowest : -2.30, -2.10, -1.83, -1.72, -1.56\nhighest: 2.20, 2.28, 2.29, 2.31, 2.37\n\n' 95%-CI (classic)\n\n\n\n\n\n\n\n\nFigure 172: Figure combining a histogram with a density plot, a boxplot and the plot of the empirical distribution function (ECDF). The scale for the x-axis is synchronized over all plots. The median can be found on the boxplot as also in the ecdf-plot. The maximum and the minimum value are tagged with a tiny vertical dash upon the ecdf-line. The mean is shown in the boxplot as grey cross, the grey bar is its confidence interval.\n\n\n\n\n\nIn comparison to the previous outlier analysis as seen here, the difference now is that the analysis is conducted on the model residuals, hence on values that are conditional on meta data (predictor variables) whereas previously the analysis was marginally or unconditionally executed with the only assumption being that of the amino acid concentration following a log-normal distribution.\nFigure 173 shows a quantile-quantile plot where the quantiles of the model’s residual values are matched to the ones predicted from a normal distribution. The diagonal line indicates the ideal fit. Data points marked in red denote outliers (also indicated in the table below each plot with their corresponding subject IDs).\nFor the rest of the figures below (i.e. for other amino acids), the same outlier detection procedure is applied but with a different parameterization which controls the outlier detection thresholds (i.e. horizontal lines in plot).\n\n\n\n\n\n\n\n\nFigure 173: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers.\n\n\n\n\n\nCompared to other models built for the rest of the amino acids, in this case there is a greater number of strong outliers that has been detected i.e. 18 subjects. These are clearly visible in the previous plot and shown in the table below.\n\n\n\n\n\n\n\n\n\nOutliers\n\n\nSubject id1\nMethionine2\n\n\n\n\n42502\n−2.10\n\n\n41757\n−1.30\n\n\n10985\n−1.56\n\n\n40691\n−1.83\n\n\n2024_7\n−1.19\n\n\n34066\n−1.20\n\n\n40470\n−1.35\n\n\n40282\n−2.30\n\n\n39756\n−1.72\n\n\n39630\n−1.29\n\n\n39494\n2.01\n\n\n37042\n1.27\n\n\n42611\n2.20\n\n\n26849\n2.28\n\n\nMpasaris\n1.94\n\n\n25983\n2.29\n\n\n44856\n2.31\n\n\n43729\n2.37\n\n\n\n1 Red coloured data points in above QQ plot\n\n\n2 μmol/g (model residual)",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---2nd-pass-9",
    "href": "modeling_110624.html#model---2nd-pass-9",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 2nd Pass",
    "text": "Model - 2nd Pass\nHere the model is refitted to the data excluding the strong outlier values detected in the previous step. Since the number of strong outliers is large, the model needs to be re-implemented and thus the model formula is not the same as the 1st pass.\nA linear and non-linear association check is conducted again:\nTest for non-linear relationships between each covariate and the amino acid concentration is executed below. This helps in deciding whether to model an association in a non-linear fashion i.e. with a polynomial term or a spline term or an interaction, or to just consider the covariates separately and without any special transformation.\n\n\n\n\n\n\n\n\nFigure 174: Spearman’s test for assessing non-linear relationships with the response. The further away from 0 the adjusted \\(\\rho^2\\) score is, the higher the degree of non-linearity for that covariate.\n\n\n\n\n\nNon-linearity evident in sex, supplements_flag and age. Most \\(\\rho^2\\) values are small.\n\n\n\n\n\n\n\n\nFigure 175: Spearman’s test for assessing linear relationships with the response. The further away from 0 the adjusted \\(\\rho^2\\) score is, the higher the degree of linearity for that covariate.\n\n\n\n\n\nLinearity is present in sex, resistance_activity, age, bmi and supplements_flag.\nTo capture non linearities, interactions amongst these variables were considered with spline transformations. The model achieving the best global significance (p-value = 0.0012) and contained the following terms:\nlog(Methionine) ~ sex + rcs(age,4) + rcs(bmi,3) + supplements_flag + log(resistance_activity+1) + sex:rcs(age,4) + sex:rcs(bmi,3) + sex:supplements_flag + sex:log(resistance_activity+1) + rcs(age,4):rcs(bmi,3) + rcs(age,4):supplements_flag + rcs(age,4):log(resistance_activity+1) + rcs(bmi,3):supplements_flag + rcs(bmi,3):log(resistance_activity+1) + supplements_flag:log(resistance_activity+1)\nWhere the : symbol denotes the interaction between two variables and rcs denotes a restricted cubic spline transformation with 3 or 4knots. This model spends 32 degrees of freedom i.e. too complex given the data size.\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 176: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed weak outliers (the strong ones detected by the 1st pass model have been removed).\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 177: Plot of predictions vs model residuals. No obvious patterns can be seen.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 178: Proportion of overall model \\(R^2\\) that is due to each predictor.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Methionine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nage\n\n\n34.0\n\n\n53.0\n\n\n19.0\n\n\n0.08486\n\n\n0.14380\n\n\n-0.1990\n\n\n0.36880\n\n\n\n\nbmi\n\n\n22.7\n\n\n29.1\n\n\n6.4\n\n\n-0.06711\n\n\n0.08255\n\n\n-0.2301\n\n\n0.09588\n\n\n\n\nresistance_activity\n\n\n0.0\n\n\n450.0\n\n\n450.0\n\n\n0.02033\n\n\n0.17140\n\n\n-0.3180\n\n\n0.35870\n\n\n\n\nsex — Male:Female\n\n\n1.0\n\n\n2.0\n\n\n\n\n-0.27340\n\n\n0.09941\n\n\n-0.4697\n\n\n-0.07713\n\n\n\n\nsupplements_flag — Yes:No\n\n\n1.0\n\n\n2.0\n\n\n\n\n0.02245\n\n\n0.10230\n\n\n-0.1796\n\n\n0.22450\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 179: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "modeling_110624.html#model---3rd-pass-7",
    "href": "modeling_110624.html#model---3rd-pass-7",
    "title": "Modeling - Exploratory Data Analysis - Amino Acid Reference Intervals",
    "section": "Model - 3rd Pass",
    "text": "Model - 3rd Pass\nThe 2nd pass model uses too many degrees of freedom (df) in relation to the size of the data i.e. 13 df should be spent instead of the 32 from the model. This can be seen by conducting a validation and calibration analysis. Below are results from the validation analysis using bootstrapping as the resampling technique. The algorithm can be described as follows source:\n\nEstimate model performance in the original sample of size n\nDraw a bootstrap sample of the same size n and fit the model to the bootstrap sample\nApply the model obtained in the bootstrap sample to the original sample\nSubtract the accuracy measure found in the bootstrap sample from the accuracy measure in the original sample - this is the estimate of optimism (i.e. overfitting)\nRepeat the process many times (e.g. 300) and average over the repeats to obtain a final estimate of optimism for each measure\nSubtract that value from the observed/apparent accuracy measure to get the optimism corrected estimate\n\n\n\n\n\n2nd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.27\n\n\n0.38\n\n\n0.06\n\n\n0.33\n\n\n-0.06\n\n\n300\n\n\n\n\nMSE\n\n\n0.1\n\n\n0.09\n\n\n0.13\n\n\n-0.05\n\n\n0.15\n\n\n300\n\n\n\n\n\\(g\\)\n\n\n0.21\n\n\n0.26\n\n\n0.16\n\n\n0.09\n\n\n0.12\n\n\n300\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n0.64\n\n\n-0.64\n\n\n0.64\n\n\n300\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.59\n\n\n0.41\n\n\n0.59\n\n\n300\n\n\n\n\n\nFrom this table it can be seen that the optimism statistic which indicates the extent of model overfitting, for a variety of performance metrics has values that are large. Thus overfitting is present in the model.\nBy calibrating the predicted values from the model to the observed ones, we also notice a good amount of deviation from the diagonal line (ideal model performance) after correcting for this overfitting or bias.\n\n\n\nn=197   Mean absolute error=0.032   Mean squared error=0.00153\n0.9 Quantile of absolute error=0.061\n\n\n\n\n\n\n\n\nFigure 180: Calibration plot for 2nd pass model. Deviation from the diagonal line after correcting for overfitting or bias.\n\n\n\n\n\nFrom these results and also the variable importance plot seen previously as well as the analysis of variance results, it looks like the variables age, bmi, and sex are most important. These variables can be kept in a new model with less degree of freedom spending i.e. less overfitting the data.\nHence the model is refitted to the data including various combinations of these 3 covariates, with the chosen model spending 16 degrees of freedom (still slightly overfitting) and having a global p-value equal to 0.0006.(Note: Situation might change when more data are collected and the model is refit).\nThe chosen model formula is:\nlog(Methionine) ~ rcs(age,4) + sex + rcs(age,4):sex + rcs(age,4):rcs(bmi,3) + rcs(bmi,3)\nThe expanded form is not shown here due to the complexity of the term rcs(age,4):rcs(bmi,3).\nThe model’s reference values can be seen below in the row named Adjust to:\n\n\n                   id    sex age   bmi chronic_disease_flag chronic_disease_v3 meds_flag supplements_flag aerobics_activity resistance_activity Methionine\nLow:effect       &lt;NA&gt;   &lt;NA&gt;  34 22.70                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                 0                   0  3.4760246\nAdjust to       24486 Female  43 25.35                   No               None        No               No                 0                   0  4.6970701\nHigh:effect      &lt;NA&gt;   &lt;NA&gt;  53 29.10                 &lt;NA&gt;               &lt;NA&gt;      &lt;NA&gt;             &lt;NA&gt;                60                 450  6.0835383\nLow:prediction   1018 Female  11 16.60                   No               None        No               No                 0                   0  0.5351004\nHigh:prediction NAKOS   Male  80 46.20                  Yes               Pain       Yes              Yes               720                 450 45.3570000\nLow              1018 Female  11 16.60                   No               None        No               No                 0                   0  0.5351004\nHigh            NAKOS   Male  80 46.20                  Yes               Pain       Yes              Yes               720                 450 45.3570000\n\nValues:\n\nid : 1018 1210 1219 1326 1338 1378 162 1623 1960 2024_1 2024_10 2024_11 2024_12 2024_2 2024_3 2024_4 2024_5 2024_6 2024_8 2024_9 + 274 others \nsex : Female Male \nchronic_disease_flag : No Yes \nchronic_disease_v3 : None Thyroidism Other Blood Heart Stomach Depression Pain \nmeds_flag : No Yes \nsupplements_flag : No Yes \n\n\n\nResiduals\n\n\n\n\n\n\n\n\nFigure 181: Normal probabibilty plot comparing quantiles of model residuals and the theoretical normal distribution. Vertical dashed lines indicate the central 95% limits of the normal distribution. Horizontal dashed lines indicate outlier detection thresholds i.e. data outside of these thresholds are deemed outliers. Here the algorithm does not report any weak outliers due to its parameterization i.e. outliers whose deviation from the straight line is not large.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 182: Plot of predictions vs model residuals. No obvious patterns can be observed.\n\n\n\n\n\n\n\nVariable Importance\n\n\n\n\n\n\n\n\nFigure 183: Proportion of overall model \\(R^2\\) that is due to each predictor. Large influence of the sex covariate. The rest of the covariates are currently kept in the model as with new data their impact might positively change.\n\n\n\n\n\n\n\nVariable Effects\n\n\n\n\nEffects   Response: log(Methionine)\n\n\n\n\n\n\nLow\n\n\nHigh\n\n\nΔ\n\n\nEffect\n\n\nS.E.\n\n\nLower 0.95\n\n\nUpper 0.95\n\n\n\n\n\n\nage\n\n\n34.0\n\n\n53.0\n\n\n19.0\n\n\n-0.031860\n\n\n0.12240\n\n\n-0.2734\n\n\n0.20960\n\n\n\n\nbmi\n\n\n22.7\n\n\n29.1\n\n\n6.4\n\n\n0.005299\n\n\n0.05805\n\n\n-0.1092\n\n\n0.11980\n\n\n\n\nsex — Male:Female\n\n\n1.0\n\n\n2.0\n\n\n\n\n-0.211300\n\n\n0.07183\n\n\n-0.3530\n\n\n-0.06956\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 184: The further away the central estimate and its corresponding intervals from unity the higher the variable’s effect. Confidence intervals are 90%, 95% and 99%, with the dark blue denoting the 90% confidence interval.\n\n\n\n\n\n\n\nPartial Dependence Plots\n\n\n\n\n\n\n\n\nFigure 185: Effect of sex. Methionine concentration levels can be seen to be higher on average in females than in males.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 186: Non-Linear effect of age. Age is seen to decrease the levels of Methionine concentration on average.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 187: Average effect of bmi on levels of Methionine concentration can be seen to have an increasing impact for bmi levels of 35 and above (not significantly though).\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 188: Simultaneous effects of age and sex. Methionine concentration levels are seen to increase on average with decreasing both and particularly for females.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 189: Simultaneous effects of age and bmi. Methionine concentration levels are seen to increase on average with decreasing both bmi (less than 30) and age (less than 30).\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 190: Simultaneous effects of bmi and sex. Methionine concentration levels are seen to increase on average especially for females.\n\n\n\n\n\n\n\nValidation & Calibration\n\n\n\n\n3rd pass model validation\n\n\n\n\nIndex\n\n\nOriginalSample\n\n\nTrainingSample\n\n\nTestSample\n\n\nOptimism\n\n\nCorrectedIndex\n\n\n\\(n\\)\n\n\n\n\n\n\nR-square\n\n\n0.18\n\n\n0.23\n\n\n0.1\n\n\n0.14\n\n\n0.05\n\n\n300\n\n\n\n\nMSE\n\n\n0.11\n\n\n0.11\n\n\n0.13\n\n\n-0.02\n\n\n0.13\n\n\n300\n\n\n\n\n\\(g\\)\n\n\n0.17\n\n\n0.19\n\n\n0.14\n\n\n0.05\n\n\n0.12\n\n\n300\n\n\n\n\nIntercept\n\n\n0\n\n\n0\n\n\n0.41\n\n\n-0.41\n\n\n0.41\n\n\n300\n\n\n\n\nSlope\n\n\n1\n\n\n1\n\n\n0.73\n\n\n0.27\n\n\n0.73\n\n\n300\n\n\n\n\n\n\n\n\nn=197   Mean absolute error=0.029   Mean squared error=0.00111\n0.9 Quantile of absolute error=0.048\n\n\n\n\n\n\n\n\nFigure 191: Calibration plot for 3rd pass model. Deviation from the diagonal line after correcting for overfitting or bias. It can be seen that deviations have been reduced compared to the 2nd pass model, especially on the right side where the model is overestimating the actual concentration values.\n\n\n\n\n\n\n\nDynamic Reference Intervals\nThe following table shows an example of the construction of a 95% reference interval (RI) for each of four subjects with specific covariate values. For the 3rd pass model only age, sex and bmi make a difference since the rest of the covariates are not used.\n\n\n\n  \n\n\n\nThe RI for Methionine from Mayo Clinic Laboratories for ages above 18 years is less than 39 μmol/g of creatinine.",
    "crumbs": [
      "Data Batch 1",
      "Modeling"
    ]
  },
  {
    "objectID": "data_desc_040624.html",
    "href": "data_desc_040624.html",
    "title": "Data Description/Processing - Ref_ranges_AAU_2 - 040624",
    "section": "",
    "text": "Data Source: Ref ranges - AAU file\nData Processing Steps:\nQ&A and manual data cleaning/clarity changes on the xlsx source file:\nid 40217 and 39683 have strange weight values. A: Take the average of these values.\nQ: On the variables aerobics_times_per_week and resistance_times_per_week, some ids have a check mark and two ids have strange values. What is the actual meaning? A: It means that in the survey form the person just said that they are exercising without specifying how many times per week. I have coded such cases with the value of 100 so that column remains of numeric type. However I change this, see here a bit further below. Also if the value was 3-4 meaning 3 or 4 times per weeks, I converted this to 3.5. Similarly for other ranges i.e. 1-2 = 1.5\nQ: What is the meaning of aerobics_duration_min? There are 4 much larger values than the rest. A: This is the duration that the person exercises per time/exercise session.\nFor ids: 41685, 1210, 39817 and 39517 changes of column aerobics_duration_min from 60120 to 90 (i.e. average), from 3040 to 35, from 4550 to 47.5 and from 1520 to 17.5\nBMI is weight/height^2 kg_per_m2, no need to be calculated in the excel source file as it is calculated after the data are imported. Also deleted empty columns in between non-empty ones. Note also the column names and the structure rearrangement on the exercise related columns. From the column name Glycine μmol/g crea removed the “crea”. Changed the name of Glutamic Acid μmol/g to Glutamate μmol/g. For the aerobics_times_per_week column there are 2 values of 45353 45385 of ids 25983 44856 which I coded as 100 i.e. they exercise but without a specific number.\nWith regards to the 100 valued cases on the exercise related columns: If aerobics_times_per_week is checked but the corresponding aerobics_duration_min column had a missing value i.e. no exercise duration, then the aerobics_times_per_week value is 0 i.e. no exercise. For the similar cases but with aerobics_duration_min having a non-zero value, then the value is checked manually and an expected value is chosen i.e. 30-45 min per week probably means once a week the person is exercising. Similarly for the resistance_times_per_week / resistance_duration_min pair of columns.\nA new columns named chronic_disease_v2 was created that is based on the chronic_disease column. It is a recoded version of the chronic_disease column having more general categories of disease in order to ease interpretation and to increase the sample size for each disease category. Information was also utilized from the meds column for cases where the chronic_disease value was missing but the meds value was not. Medicine names and their relation to a disease type were checked via search engine.\nchronic_disease_v2 is additionally lumped by frequency into 8 levels into a new column named chronic_disease_v3.\nThe column supplements has not been yet recoded as it contains a variety of vitamins and proteins. If desired, the column could be recoded towards a more specific use case i.e. effect of magnesium.\nFor later runs, perhaps 2 more changes can be made in the excel source file:\n\nRemove the Creatinine column since not needed.\nRemove the mark ‘μmol/g’ from the amino acid column names.\n\nThe above steps result in the data table output that can be found here and which is then used to proceed with the below changes and the modeling (reference interval construction).\nOnce the data is imported, the following flag/indicator (Yes/No) variables are created: chronic_disease_flag, meds_flag and supplements_flag.\nMissing values are replaced by zeroes on all of the amino acids and on these variables: aerobics_times_per_week, aerobics_duration_min, resistance_times_per_week and resistance_duration_min. These latter 4 variables are removed after being merged to the 2 following in order to create general exercise activity variables: aerobics_activity = aerobics_times_per_week * aerobics_duration_min\nresistance_activity = resistance_times_per_week * resistance_duration_min\naerobics_activity and resistance_activity are log transformed.\nThe final data set that will be used for modeling and exploratory data analysis is shown below, together with its statistical descriptions.\n\n\n\n  \n\n\n\n\n\n\n\n\n\n\n\n\n\nContinuousCategorical\n\n\n\n\n\n\n\n\n\nRef_ranges_AAU_2 Descriptives\n\n\n17 Continous Variables of 27 Variables, 308 Observations\n\n\nVariable\nLabel\nUnits\nn\nMissing\nDistinct\nInfo\nMean\nGini |Δ|\n\nQuantiles\n .05  .10  .25  .50  .75  .90  .95 \n\n\n\n\nage\nAge\nyears\n274\n34\n62\n0.999\n43.33\n15.35\n\n\n 20.0  26.3  34.0  43.0  53.0  61.0  65.7 \n\n\nweight_kg\nSubject weight in kg at test time\nkg\n240\n68\n111\n1.000\n79.97\n21.2\n\n\n 53.00  57.90  66.00  78.25  92.62  105.00  110.00 \n\n\nheight_m\nSubject height in meters\nmeters\n250\n58\n49\n0.999\n1.735\n0.1305\n\n\n 1.590  1.600  1.650  1.710  1.800  1.881  1.960 \n\n\nbmi\nBody mass index\nkg/m2\n235\n73\n219\n1.000\n26.41\n5.71\n\n\n 19.79  20.67  22.81  25.34  29.21  33.75  36.82 \n\n\naerobics_activity\nDuration of aerobic activity per week\nminutes/week\n308\n0\n32\n0.674\n48.89\n80.51\n\n\n 0.0  0.0  0.0  0.0  60.0  169.5  240.0 \n\n\nresistance_activity\nDuration of resistance (involving weights) activity per week\nminutes/week\n308\n0\n24\n0.550\n31.24\n53.27\n\n\n 0  0  0  0  0  120  180 \n\n\nGlycine\nConcentration per Creatinine gramm\nμmol/g\n308\n0\n308\n1.000\n1051\n968.4\n\n\n 230.8  281.1  438.9  700.6  1109.7  1962.3  2881.8 \n\n\nAlanine\nConcentration per Creatinine gramm\nμmol/g\n308\n0\n308\n1.000\n649.7\n667.7\n\n\n 123.0  155.0  214.9  375.4  677.0  1514.8  2267.3 \n\n\nValine\nConcentration per Creatinine gramm\nμmol/g\n308\n0\n308\n1.000\n764.3\n1469\n\n\n 8.028  11.831  18.864  25.490  33.439  44.140  49.860 \n\n\nCysteine\nConcentration per Creatinine gramm\nμmol/g\n308\n0\n193\n0.947\n895.8\n1754\n\n\n 0.000  0.000  0.000  7.062  16.854  26.570  34.249 \n\n\nTaurine\nConcentration per Creatinine gramm\nμmol/g\n308\n0\n301\n1.000\n2604\n4041\n\n\n 74.76  175.31  405.24  741.15  1365.69  3190.54  4795.22 \n\n\nIsoleucine\nConcentration per Creatinine gramm\nμmol/g\n308\n0\n308\n1.000\n1194\n2314\n\n\n 4.269  5.558  8.600  12.935  18.512  28.446  41.480 \n\n\nLeucine\nConcentration per Creatinine gramm\nμmol/g\n308\n0\n308\n1.000\n616.3\n1184\n\n\n 6.325  11.086  16.289  23.416  33.225  47.868  56.610 \n\n\nGlutamine\nConcentration per Creatinine gramm\nμmol/g\n308\n0\n308\n1.000\n375.7\n257.6\n\n\n 99.52  127.40  195.83  324.60  495.47  701.16  802.99 \n\n\nGlutamate\nConcentration per Creatinine gramm\nμmol/g\n308\n0\n308\n1.000\n911\n1762\n\n\n 4.451  6.946  11.523  19.343  35.049  58.647  94.662 \n\n\nMethionine\nConcentration per Creatinine gramm\nμmol/g\n308\n0\n303\n1.000\n1036\n2025\n\n\n 1.072  2.000  3.293  4.602  6.123  8.570  10.197 \n\n\nArginine\nConcentration per Creatinine gramm\nμmol/g\n308\n0\n306\n1.000\n769.4\n1487\n\n\n 3.558  5.256  11.651  20.551  39.182  66.752  108.042 \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRef_ranges_AAU_2 Descriptives\n\n\n10 Categorical Variables of 27 Variables, 308 Observations\n\n\nVariable\nLabel\nUnits\nn\nMissing\nDistinct\n\n\n\n\n\nid\nSubject id\n\n308\n0\n296\n1018 -\nNAKOS\nMin/Max/Mean Width: 3 / 12 / 5\n\n\nsex\nSubject gender\nFemale/Male\n258\n50\n2\n\n\n\n\nchronic_disease_flag\nDoes the subject have a chronic disease?\nYes/No\n308\n0\n2\n\n\n\n\nchronic_disease\nIf subject has a chronic disease, which one is it?\n\n308\n0\n50\n\n\n\n\nchronic_disease_v2\nRecoding of the chronic_disease information into more general types of diseases\n\n308\n0\n20\n\n\n\n\nchronic_disease_v3\nA lumped by frequency version of chronic_disease_v2 so that there are 7 categories of disease types in the data\n\n308\n0\n8\n\n\n\n\nmeds_flag\nDoes the subject take any medication?\nYes/No\n308\n0\n2\n\n\n\n\nmeds\nIf subject is taking medication, which one is it?\n\n308\n0\n106\nAcnotren 20mg -\nZinadol, T4, Nolvadex\nMin/Max/Mean Width: 2 / 44 / 9\nMode:None (n=201)\n\n\nsupplements_flag\nDoes the subject take any supplements?\nYes/No\n308\n0\n2\n\n\n\n\nsupplements\nIf subject is taking supplements, which one is it?\n\n308\n0\n78",
    "crumbs": [
      "Data Batch 1",
      "Processing"
    ]
  }
]